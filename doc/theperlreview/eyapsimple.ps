%!PS-Adobe-2.0
%%Creator: dvips(k) 5.96.1 Copyright 2007 Radical Eye Software
%%Title: theperlreview.dvi
%%CreationDate: Sun Jan 31 13:51:45 2010
%%Pages: 22
%%PageOrder: Ascend
%%BoundingBox: 0 0 596 842
%%DocumentFonts: Times-Roman Courier Times-Italic Times-Bold CMSY10
%%DocumentPaperSizes: a4
%%EndComments
%DVIPSWebPage: (www.radicaleye.com)
%DVIPSCommandLine: dvips theperlreview
%DVIPSParameters: dpi=600
%DVIPSSource:  TeX output 2010.01.31:1351
%%BeginProcSet: tex.pro 0 0
%!
/TeXDict 300 dict def TeXDict begin/N{def}def/B{bind def}N/S{exch}N/X{S
N}B/A{dup}B/TR{translate}N/isls false N/vsize 11 72 mul N/hsize 8.5 72
mul N/landplus90{false}def/@rigin{isls{[0 landplus90{1 -1}{-1 1}ifelse 0
0 0]concat}if 72 Resolution div 72 VResolution div neg scale isls{
landplus90{VResolution 72 div vsize mul 0 exch}{Resolution -72 div hsize
mul 0}ifelse TR}if Resolution VResolution vsize -72 div 1 add mul TR[
matrix currentmatrix{A A round sub abs 0.00001 lt{round}if}forall round
exch round exch]setmatrix}N/@landscape{/isls true N}B/@manualfeed{
statusdict/manualfeed true put}B/@copies{/#copies X}B/FMat[1 0 0 -1 0 0]
N/FBB[0 0 0 0]N/nn 0 N/IEn 0 N/ctr 0 N/df-tail{/nn 8 dict N nn begin
/FontType 3 N/FontMatrix fntrx N/FontBBox FBB N string/base X array
/BitMaps X/BuildChar{CharBuilder}N/Encoding IEn N end A{/foo setfont}2
array copy cvx N load 0 nn put/ctr 0 N[}B/sf 0 N/df{/sf 1 N/fntrx FMat N
df-tail}B/dfs{div/sf X/fntrx[sf 0 0 sf neg 0 0]N df-tail}B/E{pop nn A
definefont setfont}B/Cw{Cd A length 5 sub get}B/Ch{Cd A length 4 sub get
}B/Cx{128 Cd A length 3 sub get sub}B/Cy{Cd A length 2 sub get 127 sub}
B/Cdx{Cd A length 1 sub get}B/Ci{Cd A type/stringtype ne{ctr get/ctr ctr
1 add N}if}B/CharBuilder{save 3 1 roll S A/base get 2 index get S
/BitMaps get S get/Cd X pop/ctr 0 N Cdx 0 Cx Cy Ch sub Cx Cw add Cy
setcachedevice Cw Ch true[1 0 0 -1 -.1 Cx sub Cy .1 sub]{Ci}imagemask
restore}B/D{/cc X A type/stringtype ne{]}if nn/base get cc ctr put nn
/BitMaps get S ctr S sf 1 ne{A A length 1 sub A 2 index S get sf div put
}if put/ctr ctr 1 add N}B/I{cc 1 add D}B/bop{userdict/bop-hook known{
bop-hook}if/SI save N @rigin 0 0 moveto/V matrix currentmatrix A 1 get A
mul exch 0 get A mul add .99 lt{/QV}{/RV}ifelse load def pop pop}N/eop{
SI restore userdict/eop-hook known{eop-hook}if showpage}N/@start{
userdict/start-hook known{start-hook}if pop/VResolution X/Resolution X
1000 div/DVImag X/IEn 256 array N 2 string 0 1 255{IEn S A 360 add 36 4
index cvrs cvn put}for pop 65781.76 div/vsize X 65781.76 div/hsize X}N
/p{show}N/RMat[1 0 0 -1 0 0]N/BDot 260 string N/Rx 0 N/Ry 0 N/V{}B/RV/v{
/Ry X/Rx X V}B statusdict begin/product where{pop false[(Display)(NeXT)
(LaserWriter 16/600)]{A length product length le{A length product exch 0
exch getinterval eq{pop true exit}if}{pop}ifelse}forall}{false}ifelse
end{{gsave TR -.1 .1 TR 1 1 scale Rx Ry false RMat{BDot}imagemask
grestore}}{{gsave TR -.1 .1 TR Rx Ry scale 1 1 false RMat{BDot}
imagemask grestore}}ifelse B/QV{gsave newpath transform round exch round
exch itransform moveto Rx 0 rlineto 0 Ry neg rlineto Rx neg 0 rlineto
fill grestore}B/a{moveto}B/delta 0 N/tail{A/delta X 0 rmoveto}B/M{S p
delta add tail}B/b{S p tail}B/c{-4 M}B/d{-3 M}B/e{-2 M}B/f{-1 M}B/g{0 M}
B/h{1 M}B/i{2 M}B/j{3 M}B/k{4 M}B/w{0 rmoveto}B/l{p -4 w}B/m{p -3 w}B/n{
p -2 w}B/o{p -1 w}B/q{p 1 w}B/r{p 2 w}B/s{p 3 w}B/t{p 4 w}B/x{0 S
rmoveto}B/y{3 2 roll p a}B/bos{/SS save N}B/eos{SS restore}B end

%%EndProcSet
%%BeginProcSet: 8r.enc 0 0
% File 8r.enc  TeX Base 1 Encoding  Revision 2.0  2002-10-30
%
% @@psencodingfile@{
%   author    = "S. Rahtz, P. MacKay, Alan Jeffrey, B. Horn, K. Berry,
%                W. Schmidt, P. Lehman",
%   version   = "2.0",
%   date      = "27nov06",
%   filename  = "8r.enc",
%   email     = "tex-fonts@@tug.org",
%   docstring = "This is the encoding vector for Type1 and TrueType
%                fonts to be used with TeX.  This file is part of the
%                PSNFSS bundle, version 9"
% @}
% 
% The idea is to have all the characters normally included in Type 1 fonts
% available for typesetting. This is effectively the characters in Adobe
% Standard encoding, ISO Latin 1, Windows ANSI including the euro symbol,
% MacRoman, and some extra characters from Lucida.
% 
% Character code assignments were made as follows:
% 
% (1) the Windows ANSI characters are almost all in their Windows ANSI
% positions, because some Windows users cannot easily reencode the
% fonts, and it makes no difference on other systems. The only Windows
% ANSI characters not available are those that make no sense for
% typesetting -- rubout (127 decimal), nobreakspace (160), softhyphen
% (173). quotesingle and grave are moved just because it's such an
% irritation not having them in TeX positions.
% 
% (2) Remaining characters are assigned arbitrarily to the lower part
% of the range, avoiding 0, 10 and 13 in case we meet dumb software.
% 
% (3) Y&Y Lucida Bright includes some extra text characters; in the
% hopes that other PostScript fonts, perhaps created for public
% consumption, will include them, they are included starting at 0x12.
% These are /dotlessj /ff /ffi /ffl.
% 
% (4) hyphen appears twice for compatibility with both ASCII and Windows.
%
% (5) /Euro was assigned to 128, as in Windows ANSI
%
% (6) Missing characters from MacRoman encoding incorporated as follows:
%
%     PostScript      MacRoman        TeXBase1
%     --------------  --------------  --------------
%     /notequal       173             0x16
%     /infinity       176             0x17
%     /lessequal      178             0x18
%     /greaterequal   179             0x19
%     /partialdiff    182             0x1A
%     /summation      183             0x1B
%     /product        184             0x1C
%     /pi             185             0x1D
%     /integral       186             0x81
%     /Omega          189             0x8D
%     /radical        195             0x8E
%     /approxequal    197             0x8F
%     /Delta          198             0x9D
%     /lozenge        215             0x9E
%
/TeXBase1Encoding [
% 0x00
 /.notdef /dotaccent /fi /fl
 /fraction /hungarumlaut /Lslash /lslash
 /ogonek /ring /.notdef /breve
 /minus /.notdef /Zcaron /zcaron
% 0x10
 /caron /dotlessi /dotlessj /ff
 /ffi /ffl /notequal /infinity
 /lessequal /greaterequal /partialdiff /summation
 /product /pi /grave /quotesingle
% 0x20
 /space /exclam /quotedbl /numbersign
 /dollar /percent /ampersand /quoteright
 /parenleft /parenright /asterisk /plus
 /comma /hyphen /period /slash
% 0x30
 /zero /one /two /three
 /four /five /six /seven
 /eight /nine /colon /semicolon
 /less /equal /greater /question
% 0x40
 /at /A /B /C
 /D /E /F /G
 /H /I /J /K
 /L /M /N /O
% 0x50
 /P /Q /R /S
 /T /U /V /W
 /X /Y /Z /bracketleft
 /backslash /bracketright /asciicircum /underscore
% 0x60
 /quoteleft /a /b /c
 /d /e /f /g
 /h /i /j /k
 /l /m /n /o
% 0x70
 /p /q /r /s
 /t /u /v /w
 /x /y /z /braceleft
 /bar /braceright /asciitilde /.notdef
% 0x80
 /Euro /integral /quotesinglbase /florin
 /quotedblbase /ellipsis /dagger /daggerdbl
 /circumflex /perthousand /Scaron /guilsinglleft
 /OE /Omega /radical /approxequal
% 0x90
 /.notdef /.notdef /.notdef /quotedblleft
 /quotedblright /bullet /endash /emdash
 /tilde /trademark /scaron /guilsinglright
 /oe /Delta /lozenge /Ydieresis
% 0xA0
 /.notdef /exclamdown /cent /sterling
 /currency /yen /brokenbar /section
 /dieresis /copyright /ordfeminine /guillemotleft
 /logicalnot /hyphen /registered /macron
% 0xB0
 /degree /plusminus /twosuperior /threesuperior
 /acute /mu /paragraph /periodcentered
 /cedilla /onesuperior /ordmasculine /guillemotright
 /onequarter /onehalf /threequarters /questiondown
% 0xC0
 /Agrave /Aacute /Acircumflex /Atilde
 /Adieresis /Aring /AE /Ccedilla
 /Egrave /Eacute /Ecircumflex /Edieresis
 /Igrave /Iacute /Icircumflex /Idieresis
% 0xD0
 /Eth /Ntilde /Ograve /Oacute
 /Ocircumflex /Otilde /Odieresis /multiply
 /Oslash /Ugrave /Uacute /Ucircumflex
 /Udieresis /Yacute /Thorn /germandbls
% 0xE0
 /agrave /aacute /acircumflex /atilde
 /adieresis /aring /ae /ccedilla
 /egrave /eacute /ecircumflex /edieresis
 /igrave /iacute /icircumflex /idieresis
% 0xF0
 /eth /ntilde /ograve /oacute
 /ocircumflex /otilde /odieresis /divide
 /oslash /ugrave /uacute /ucircumflex
 /udieresis /yacute /thorn /ydieresis
] def


%%EndProcSet
%%BeginProcSet: texps.pro 0 0
%!
TeXDict begin/rf{findfont dup length 1 add dict begin{1 index/FID ne 2
index/UniqueID ne and{def}{pop pop}ifelse}forall[1 index 0 6 -1 roll
exec 0 exch 5 -1 roll VResolution Resolution div mul neg 0 0]FontType 0
ne{/Metrics exch def dict begin Encoding{exch dup type/integertype ne{
pop pop 1 sub dup 0 le{pop}{[}ifelse}{FontMatrix 0 get div Metrics 0 get
div def}ifelse}forall Metrics/Metrics currentdict end def}{{1 index type
/nametype eq{exit}if exch pop}loop}ifelse[2 index currentdict end
definefont 3 -1 roll makefont/setfont cvx]cvx def}def/ObliqueSlant{dup
sin S cos div neg}B/SlantFont{4 index mul add}def/ExtendFont{3 -1 roll
mul exch}def/ReEncodeFont{CharStrings rcheck{/Encoding false def dup[
exch{dup CharStrings exch known not{pop/.notdef/Encoding true def}if}
forall Encoding{]exch pop}{cleartomark}ifelse}if/Encoding exch def}def
end

%%EndProcSet
%%BeginFont: CMSY10
%!PS-AdobeFont-1.1: CMSY10 1.0
%%CreationDate: 1991 Aug 15 07:20:57
% Copyright (C) 1997 American Mathematical Society. All Rights Reserved.
11 dict begin
/FontInfo 7 dict dup begin
/version (1.0) readonly def
/Notice (Copyright (C) 1997 American Mathematical Society. All Rights Reserved) readonly def
/FullName (CMSY10) readonly def
/FamilyName (Computer Modern) readonly def
/Weight (Medium) readonly def
/ItalicAngle -14.035 def
/isFixedPitch false def
end readonly def
/FontName /CMSY10 def
/PaintType 0 def
/FontType 1 def
/FontMatrix [0.001 0 0 0.001 0 0] readonly def
/Encoding 256 array
0 1 255 {1 index exch /.notdef put} for
dup 15 /bullet put
readonly def
/FontBBox{-29 -960 1116 775}readonly def
currentdict end
currentfile eexec
D9D66F633B846A97B686A97E45A3D0AA052F09F9C8ADE9D907C058B87E9B6964
7D53359E51216774A4EAA1E2B58EC3176BD1184A633B951372B4198D4E8C5EF4
A213ACB58AA0A658908035BF2ED8531779838A960DFE2B27EA49C37156989C85
E21B3ABF72E39A89232CD9F4237FC80C9E64E8425AA3BEF7DED60B122A52922A
221A37D9A807DD01161779DDE7D31FF2B87F97C73D63EECDDA4C49501773468A
27D1663E0B62F461F6E40A5D6676D1D12B51E641C1D4E8E2771864FC104F8CBF
5B78EC1D88228725F1C453A678F58A7E1B7BD7CA700717D288EB8DA1F57C4F09
0ABF1D42C5DDD0C384C7E22F8F8047BE1D4C1CC8E33368FB1AC82B4E96146730
DE3302B2E6B819CB6AE455B1AF3187FFE8071AA57EF8A6616B9CB7941D44EC7A
71A7BB3DF755178D7D2E4BB69859EFA4BBC30BD6BB1531133FD4D9438FF99F09
4ECC068A324D75B5F696B8688EEB2F17E5ED34CCD6D047A4E3806D000C199D7C
515DB70A8D4F6146FE068DC1E5DE8BC5703711DA090312BA3FC00A08C453C609
C627A8BECD6E1FA14A3B02476E90AAD8B4700C400380BC9AFFBF7847EB28661B
9DC3AA0F44C533F2E07DCC4DE19D367BF223E33DC321D0247A0E6EF6ABC8FA52
15AE044094EF678A8726CD7C011F02BFF8AB6EAEEE391AD837120823BED0B5D8
F8B15245377871A64F78378BB4330149D6941F7A86FBFFC49B93C94155F5FA7D
F22E7214511C0A92693F4CDBF38411651540572F2DD70D924AE0F18E1CD581F3
C871399127FF5D07A868885B5FF7CDEB50B8323B2533DEF8DC973B1AE84FA0A2

0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000
cleartomark
%%EndFont 
TeXDict begin 39158280 55380996 1000 600 600 (theperlreview.dvi)
@start /Fa 139[18 1[26 1[33 33 33 1[18 29 1[18 33 2[29
3[33 7[37 1[55 2[37 18[41 65[{TeXBase1Encoding ReEncodeFont}15
66.4176 /Times-Italic rf /Fb 134[40 2[40 40 40 40 40
1[40 40 40 40 7[40 40 1[40 40 7[40 40 40 2[40 40 40 1[40
40 40 40 40 2[40 40 40 40 40 40 2[40 6[40 11[40 40 8[40
36[{TeXBase1Encoding ReEncodeFont}36 66.4176 /Courier
rf /Fc 134[33 33 48 33 33 18 26 22 1[33 33 33 52 18 33
18 18 33 33 22 29 33 29 33 29 7[48 1[63 1[48 41 37 3[48
5[22 4[48 1[44 48 6[18 11[17 22 17 4[22 36[37 2[{
TeXBase1Encoding ReEncodeFont}40 66.4176 /Times-Roman
rf /Fd 198[25 25 25 25 25 25 25 25 25 49[{TeXBase1Encoding ReEncodeFont}
9 49.8132 /Times-Roman rf /Fe 198[29 29 29 29 29 29 29
29 29 49[{TeXBase1Encoding ReEncodeFont}9 58.1154 /Times-Roman
rf /Ff 138[55 33 39 3[50 55 83 28 2[28 55 50 1[44 55
44 55 50 12[66 55 15[72 66 72 11[50 2[50 50 2[25 42[55
3[{TeXBase1Encoding ReEncodeFont}25 99.6264 /Times-Bold
rf /Fg 105[42 28[42 2[42 46 28 32 37 2[42 46 69 23 2[23
46 42 28 37 1[37 46 42 10[60 2[46 4[60 1[55 65 2[65 3[60
60 21[28 45[{TeXBase1Encoding ReEncodeFont}28 83.022
/Times-Bold rf /Fh 240[42 15[{}1 83.022 /CMSY10 rf /Fi
103[50 15[50 10[50 50 50 50 50 50 50 50 50 50 50 50 50
50 50 50 50 50 50 1[50 50 50 50 50 50 50 50 50 50 50
1[50 50 50 50 50 50 50 50 50 50 50 50 1[50 50 50 50 50
50 1[50 50 50 50 50 50 50 50 50 50 50 50 50 50 50 50
50 50 50 50 50 50 50 50 50 50 50 50 50 50 50 50 50 50
50 50 50 50 50 50 34[{TeXBase1Encoding ReEncodeFont}90
83.022 /Courier rf /Fj 133[32 37 37 55 37 42 23 32 32
1[42 42 42 60 23 37 1[23 42 42 23 37 42 37 42 42 7[46
51 69 51 60 46 42 51 1[51 1[55 1[46 2[28 1[60 51 51 60
2[51 6[28 3[42 4[42 42 1[21 28 21 2[28 28 36[42 3[{
TeXBase1Encoding ReEncodeFont}51 83.022 /Times-Italic
rf /Fk 105[42 1[37 25[37 42 42 60 42 42 23 32 28 42 42
42 42 65 23 42 23 23 42 42 28 37 42 37 42 37 28 2[28
1[28 1[60 1[78 60 60 51 46 55 1[46 60 60 74 51 1[32 28
60 60 46 51 60 55 55 60 1[37 3[23 23 42 42 42 42 42 42
42 42 42 42 23 21 28 21 47 1[28 28 28 3[42 31[46 46 2[{
TeXBase1Encoding ReEncodeFont}77 83.022 /Times-Roman
rf /Fl 134[60 60 86 1[66 40 47 53 1[66 60 66 100 33 66
1[33 66 60 40 53 66 53 66 60 9[120 2[80 66 86 1[73 93
2[80 2[47 1[93 73 2[86 1[86 7[60 60 60 60 60 60 60 60
60 60 48[{TeXBase1Encoding ReEncodeFont}44 119.552 /Times-Bold
rf /Fm 134[37 37 54 1[37 21 29 25 1[37 37 37 58 21 37
1[21 37 37 25 33 37 33 37 33 7[54 4[46 1[50 1[42 1[54
4[25 2[42 46 54 50 50 7[21 4[37 3[37 37 21 19 25 19 2[25
25 36[42 42 2[{TeXBase1Encoding ReEncodeFont}45 74.7198
/Times-Roman rf /Fn 139[25 29 33 14[33 42 37 31[54 65[{
TeXBase1Encoding ReEncodeFont}7 74.7198 /Times-Bold rf
/Fo 75[33 57[44 50 2[50 50 28 39 33 1[50 50 50 78 3[28
1[50 1[44 50 44 1[44 11[72 2[66 2[72 2[61 1[39 33 3[61
72 66 15[50 50 50 50 1[25 33 25 26[28 17[{TeXBase1Encoding ReEncodeFont}
35 99.6264 /Times-Roman rf /Fp 138[72 40 56 56 1[72 72
72 104 40 2[40 3[64 72 64 25[48 5[96 1[88 23[48 48 40[{
TeXBase1Encoding ReEncodeFont}18 143.462 /Times-Italic
rf /Fq 134[86 5[86 86 1[86 10[86 3[86 16[86 10[86 10[86
58[{TeXBase1Encoding ReEncodeFont}9 143.462 /Courier
rf /Fr 136[104 2[40 56 48 3[72 4[40 72 72 1[64 72 2[64
12[88 80 2[80 80[{TeXBase1Encoding ReEncodeFont}14 143.462
/Times-Roman rf end
%%EndProlog
%%BeginSetup
%%Feature: *Resolution 600dpi
TeXDict begin
%%BeginPaperSize: a4
/setpagedevice where
{ pop << /PageSize [595 842] >> setpagedevice }
{ /a4 where { pop a4 } if }
ifelse
%%EndPaperSize
 end
%%EndSetup
%%Page: 1 1
TeXDict begin 1 0 bop 535 872 a Fr(P)n(arsing)35 b(Strings)f(and)h(T)-5
b(rees)34 b(with)h Fq(Parse::Eyapp)691 1054 y Fp(\(An)g(Intr)-6
b(oduction)33 b(to)i(Compiler)f(Construction\))1447 1295
y Fo(Casiano)25 b(Rodriguez-Leon)627 1411 y(Dpto.)30
b(Estad)m(\264)-30 b(\021stica,)24 b(I.O.)h(y)f(Computaci)8
b(\264)-41 b(on.)30 b(Uni)n(v)o(ersidad)23 b(de)i(La)g(Laguna)1605
1606 y(January)g(31,)f(2010)1808 1904 y Fn(Abstract)834
2041 y Fm(P)o(arse::Eyapp)18 b(\(Extended)h(yapp\))g(is)e(a)h
(collection)h(of)f(modules)g(that)g(e)o(xtends)h(Francois)722
2133 y(Desarmenien)27 b(P)o(arse::Y)-7 b(app)26 b(1.05.)45
b(Eyapp)27 b(e)o(xtends)g(yacc/yapp)h(syntax)f(with)f(function-)722
2224 y(alities)k(lik)o(e)g(named)h(attrib)o(utes,)g(EBNF-lik)o(e)e(e)o
(xpressions,)34 b(modi\002able)d(def)o(ault)f(action,)722
2315 y(automatic)g(abstract)f(syntax)g(tree)g(b)o(uilding,)i(dynamic)f
(con\003ict)f(resolution,)j(translation)722 2407 y(schemes,)g(tree)d
(re)o(gular)g(e)o(xpressions,)j(tree)c(transformations,)k(scope)d
(analysis)h(support,)722 2498 y(and)20 b(directed)f(ac)o(yclic)g
(graphs)h(among)g(others.)834 2589 y(This)14 b(article)g(teaches)h(you)
h(the)e(basics)h(of)f(Compiler)h(Construction)g(using)g(P)o
(arse::Eyapp)722 2681 y(to)k(b)o(uild)g(a)g(translator)g(from)g
(in\002x)f(e)o(xpressions)j(to)d(P)o(arrot)g(Intermediate)i
(Representation.)515 2961 y Fl(1)119 b(Intr)n(oduction)515
3146 y Fk(Almost)27 b(an)o(y)g(Perl)h(programmer)d(kno)n(ws)i(what)g
Fj(P)-7 b(ar)o(sing)28 b Fk(is)h(about.)46 b(One)28 b(of)f(the)h
(strengths)f(of)515 3246 y(Perl)20 b(is)g(its)h(e)o(xcellence)d(for)h
(te)o(xt)h(analysis.)k(Additionally)18 b(to)i(its)h(embedded)c(re)o
(gular)h(e)o(xpression)515 3346 y(capacities,)32 b(modules)c(lik)o(e)i
(P)o(arse::RecDescent)g([1)o(])g(and)f(P)o(arse::Y)-8
b(app)29 b([2)o(])h(mak)o(e)g(easier)g(the)515 3445 y(task)20
b(of)g(te)o(xt)g(understanding)d(and)j(te)o(xt)g(transformation.)639
3545 y(P)o(arse::Eyapp)e(\(Extended)e(yapp\))i(is)i(a)f(collection)f
(of)h(modules)f(that)h(e)o(xtends)f(Francois)h(De-)515
3645 y(sarmenien)j(P)o(arse::Y)-8 b(app)23 b Fi(1.05)p
Fk(:)32 b(An)o(y)24 b Fi(yapp)f Fk(program)f(runs)h(without)g(changes)g
(with)h(e)o(yapp.)515 3744 y(Additionally)e(P)o(arse::Eyapp)h(pro)o
(vides)f(ne)n(w)i(functionalities)f(lik)o(e)h(named)f(attrib)n(utes,)i
(EBNF-)515 3844 y(lik)o(e)f(e)o(xpressions,)g(modi\002able)f(def)o
(ault)g(actions,)i(abstract)f(syntax)f(tree)i(b)n(uilding)d(and)i
(transla-)515 3943 y(tion)c(schemes.)k(It)d(also)f(pro)o(vides)f(a)h
(language)f(for)g(tree)i(transformations.)639 4043 y(This)16
b(article)f(introduces)f(the)h(basics)g(of)g(translator)g(construction)
e(with)i(P)o(arse::Eyapp)f(through)515 4143 y(an)32 b(e)o(xample)f
(that)h(compiles)f(in\002x)h(e)o(xpressions)f(into)h(P)o(arrot)g
(Intermediate)e(Representation)515 4242 y(\(PIR\)[3)n(].)61
b(P)o(arrot)31 b(is)i(a)f(virtual)f(machine)g(\(VM\),)g(similar)h(to)g
(the)g(Ja)n(v)n(a)g(VM)h(and)e(the)h(.NET)515 4342 y(VM.)20
b(Ho)n(we)n(v)o(er)m(,)e(unlik)o(e)i(these)g(tw)o(o)g(which)g(are)g
(designed)f(for)h(statically-typed)f(languages)f(lik)o(e)515
4442 y(Ja)n(v)n(a)23 b(or)f(C#,)h(P)o(arrot)f(is)h(designed)f(for)f
(use)i(with)g(dynamically)d(typed)i(languages)f(such)h(as)h(Perl,)515
4541 y(Python,)c(Ruby)-5 b(,)19 b(or)g(PHP)-9 b(.)639
4641 y(The)23 b(input)f(to)i(the)f(program)e(will)j(be)f(a)h
(\(semicolon)d(separated\))h(list)i(of)f(in\002x)g(e)o(xpressions,)515
4740 y(lik)o(e)d(in)h(this)f(e)o(xample)f(located)h(in)g(\002le)h
Fi(input1.inf)p Fk(:)515 4906 y Fi($)49 b(cat)h(input1.inf)515
5006 y(b)f(=)h(5;)1926 5255 y Fk(1)p eop end
%%Page: 2 2
TeXDict begin 2 1 bop 515 523 a Fi(a)49 b(=)h(b+2;)515
623 y(a)f(=)h(2)764 638 y(*)814 623 y(\(a+b\))1064 638
y(*)1114 623 y(\(2-4/2\);)515 722 y(print)f(a;)515 822
y(d)g(=)h(\(a)f(=)h(a+1\))1163 837 y(*)1213 822 y(4-b;)515
922 y(c)f(=)h(a)764 937 y(*)814 922 y(b+d;)515 1021 y(print)f(c;)515
1121 y(print)g(d)639 1287 y Fk(and)20 b(the)g(output)f(is)i(the)f(PIR)h
(resulting)f(from)f(the)h(translation:)565 1453 y Fi(1)99
b(.sub)49 b('main')g(:main)565 1553 y(2)248 b(.local)49
b(num)g(a,)h(b,)f(c,)h(d)565 1652 y(3)248 b(b)50 b(=)g(5)565
1752 y(4)248 b(a)50 b(=)g(b)f(+)h(2)565 1851 y(5)248
b(a)50 b(=)g(0)f(#)h(expression)e(at)h(line)g(3)565 1951
y(6)248 b(print)49 b("a)h(=)f(")249 b(#)50 b(above)f(was)565
2051 y(7)248 b(print)49 b(a)199 b(#)50 b(reduced)f(to)g(zero)565
2150 y(8)248 b(print)49 b("\\n")g(#)h(at)f(compile)g(time)565
2250 y(9)248 b(a)50 b(=)g(a)f(+)h(1)515 2350 y(10)248
b($N5)50 b(=)f(a)1262 2365 y(*)1362 2350 y(4)515 2449
y(11)248 b(d)50 b(=)g($N5)f(-)h(b)515 2549 y(12)248 b($N7)50
b(=)f(a)1262 2564 y(*)1362 2549 y(b)515 2648 y(13)248
b(c)50 b(=)g($N7)f(+)h(d)515 2748 y(14)248 b(print)49
b("c)h(=)f(")515 2848 y(15)248 b(print)49 b(c)515 2947
y(16)248 b(print)49 b("\\n")515 3047 y(17)248 b(print)49
b("d)h(=)f(")515 3147 y(18)248 b(print)49 b(d)515 3246
y(19)248 b(print)49 b("\\n")515 3346 y(20)99 b(.end)639
3512 y Fk(Y)-9 b(ou)15 b(can)g(do)n(wnload)e(the)i(code)g(for)f(this)i
(e)o(xample)e(from)g(http://nereida.deioc.ull.es/)e(pl/e)o
(yapsimple/source.tgz.)515 3611 y(T)-7 b(o)20 b(use)h(it,)f(unpack)f
(the)h(tarball:)515 3778 y Fi(tar)49 b(xvzf)g(source.tgz)515
3944 y Fk(Change)19 b(to)h(the)h(directory:)515 4110
y Fi(cd)49 b(src)515 4276 y Fk(and)19 b(compile)h(the)g(grammar)e(with)
j(e)o(yapp:)515 4442 y Fi(eyapp)49 b(Infix.eyp)515 4608
y Fk(Compile)19 b(also)i(the)f(set)h(of)f(tree)g(transformations)e
(using)i(treere)o(g:)515 4774 y Fi(treereg)48 b(-m)i(main)f(I2PIR.trg)
515 4940 y Fk(After)20 b(these)g(tw)o(o)g(compilations)f(we)i(ha)n(v)o
(e)e(tw)o(o)i(ne)n(w)f(modules:)p eop end
%%Page: 3 3
TeXDict begin 3 2 bop 515 523 a Fi(nereida:/tmp/src>)46
b(ls)k(-ltr)f(|tail)g(-2)515 623 y(-rw-rw----)97 b(1)50
b(pl)g(users)148 b(Infix.pm)515 722 y(-rw-rw----)97 b(1)50
b(pl)g(users)148 b(I2PIR.pm)515 888 y Fk(Module)26 b
Fi(Infix.pm)g Fk(contains)g(the)h(parser)g(for)f(the)h(grammar)f
(described)g(in)h Fi(Infix.eyp)p Fk(.)515 988 y(Module)14
b Fi(I2PIR.pm)g Fk(contains)h(the)g(collection)f(of)h(tree)g
(transformations)e(described)h(in)h Fi(I2PIR.trg)p Fk(.)515
1088 y(No)n(w)20 b(we)g(can)g(run)g(the)g(script)g Fi(infix2pir.pl)f
Fk(which)g(mak)o(es)h(use)h(of)f(these)g(tw)o(o)h(modules:)515
1254 y Fi($)49 b(./infix2pir.pl)f(input1.inf)g(>)h(input1.pir)515
1420 y Fk(W)-7 b(e)21 b(can)f(no)n(w)g(mak)o(e)f(use)i(of)f(the)g
Fi(parrot)g Fk(interpreter)e(to)j(e)o(x)o(ecute)d(the)j(code:)515
1586 y Fi($)49 b(/Users/casianorodriguezleon/src/parro)o(t/parr)o
(ot-1.)o(9.0/p)o(arrot)43 b(input1.pir)515 1685 y(a)49
b(=)h(0)515 1785 y(c)f(=)h(4)515 1885 y(d)f(=)h(-1)515
2165 y Fl(2)119 b(A)30 b(F)m(ast)f(Intr)n(oduction)i(to)e(P)o(arr)n(ot)
515 2350 y Fk(The)i(P)o(arrot)g(virtual)g(machine)g([4)o(])h(is)h(re)o
(gister)e(based.)60 b(This)32 b(means)f(that,)k(lik)o(e)d(a)g(hardw)o
(are)515 2450 y(CPU,)21 b(it)h(has)f(a)g(number)e(of)h(f)o(ast-access)h
(units)g(of)g(storage)f(called)g(re)o(gisters.)26 b(There)20
b(are)h(4)g(types)515 2550 y(of)27 b(re)o(gister)h(in)g(P)o(arrot:)40
b(inte)o(gers)27 b(\()p Fi(I)p Fk(\),)h(numbers)e(\()p
Fi(N)p Fk(\),)i(strings)g(\()p Fi(S)p Fk(\))f(and)h(PMCs)h(\()p
Fi(P)p Fk(\).)e(F)o(or)h(each)515 2649 y(type)k(there)g(are)g(se)n(v)o
(eral)g(of)g(these,)k(named)31 b Fi($N0)p Fk(,)36 b Fi($N1)p
Fk(,)f(.)12 b(.)g(.)g(Number)32 b(re)o(gisters)g(map)g(to)h(the)515
2749 y(machine)21 b(nati)n(v)o(e)h(\003oating)f(point)h(type.)32
b(Y)-9 b(ou)21 b(can)i(do)n(wnload)d(a)j(recent)f(v)o(ersion)f(of)h
(parrot)g(from)515 2848 y(http://www)-5 b(.parrot.or)o(g/do)n(w)o(nloa)
o(d.)639 2948 y(The)26 b(code)g(produced)e(by)i Fi(infix2pir.pl)f
Fk(is)i(an)g(e)o(xample)e(of)h(PIR,)h(which)f(stands)g(for)515
3048 y(P)o(arrot)g(Intermediate)f(Representation)g(and)h(is)i(also)f
(kno)n(wn)f(as)h(Intermediate)e(Code)i(or)f(IMC.)515
3147 y(PIR)17 b(\002les)g(use)f(the)h(e)o(xtension)d
Fi(.pir)p Fk(.)24 b(PIR)17 b(is)g(an)f(intermediate)f(language)f(that)j
(can)f(be)g(compiled)515 3247 y(to)h(P)o(arrot)g(Byte)g(code)g
(\(PBC\).)h(It)f(w)o(as)h(concei)n(v)o(ed)d(as)j(a)g(possible)f(tar)o
(get)f(language)g(for)h(compilers)515 3347 y(tar)o(geting)j(the)i(P)o
(arrot)g(V)-5 b(irtual)22 b(Machine.)30 b(PIR)23 b(is)g(halfw)o(ay)e
(between)h(a)g(High)g(Le)n(v)o(el)g(Language)515 3446
y(\(HLL\))d(and)h(P)o(arrot)f(Assembly)h(\(P)-8 b(ASM\).)639
3546 y(PIR)25 b(has)f(a)g(relati)n(v)o(ely)f(simple)h(syntax.)35
b(Ev)o(ery)22 b(line)i(is)h(a)f(comment,)f(a)h(label,)h(a)f(statement,)
515 3645 y(or)k(a)g(directi)n(v)o(e.)48 b(Each)28 b(statement)g(or)g
(directi)n(v)o(e)f(stands)i(on)f(its)h(o)n(wn)f(line.)49
b(There)27 b(is)j(no)d(end-)515 3745 y(of-line)e(symbol)g(\(such)h(as)h
(a)g(semicolon)e(in)i(C\).)g(These)f(is)h(a)g(brief)f(enumeration)d(of)
k(the)f(main)515 3845 y(characteristics)19 b(of)h(the)g(language:)639
4027 y Fh(\017)41 b Fg(Comments)35 b Fk(A)17 b(comment)f(be)o(gins)g
(with)h(the)f Fi(#)i Fk(symbol,)e(and)g(continues)g(until)h(the)g(end)f
(of)722 4127 y(the)k(line.)26 b(Comments)19 b(can)h(stand)g(alone)g(on)
f(a)i(line)f(or)g(follo)n(w)g(a)g(statement)g(or)g(directi)n(v)o(e.)639
4293 y Fh(\017)41 b Fg(Statements)722 4426 y Fk(A)23
b(statement)e(is)i(either)e(an)h(opcode)e(or)i(syntactic)f(sugar)g(for)
g(one)h(or)f(more)g(opcodes.)29 b(An)722 4526 y(opcode)21
b(is)i(a)g(nati)n(v)o(e)f(instruction)f(for)g(the)i(virtual)e(machine;)
i(it)g(consists)g(of)f(the)g(name)g(of)722 4625 y(the)e(instruction)f
(follo)n(wed)g(by)h(zero)g(or)g(more)f(ar)o(guments.)639
4791 y Fh(\017)41 b Fg(Higher)m(-le)o(v)o(el)19 b(constructs)722
4924 y Fk(PIR)i(also)g(pro)o(vides)d(higher)n(-le)n(v)o(el)g
(constructs,)h(including)g(symbolic)g(operators:)p eop
end
%%Page: 4 4
TeXDict begin 4 3 bop 822 523 a Fi($I1)49 b(=)h(2)f(+)h(5)722
739 y Fk(These)23 b(special)g(statement)f(forms)h(are)f(just)i
(syntactic)e(sugar)g(for)g(re)o(gular)f(opcodes.)32 b(The)722
839 y Fi(+)21 b Fk(symbol)f(corresponds)e(to)i(the)h
Fi(add)f Fk(opcode,)f(the)h Fi(-)h Fk(symbol)e(to)i(the)f
Fi(sub)h Fk(opcode,)d(and)722 938 y(so)j(on.)j(The)c(pre)n(vious)f(e)o
(xample)g(is)i(equi)n(v)n(alent)d(to:)822 1154 y Fi(add)49
b($I1,)g(2,)h(5)639 1370 y Fh(\017)41 b Fg(Dir)o(ecti)o(v)o(es)722
1503 y Fk(Directi)n(v)o(es)22 b(resemble)g(opcodes,)g(b)n(ut)h(the)o(y)
f(be)o(gin)f(with)i(a)g(period)e(\()p Fi(.)p Fk(\).)32
b(Some)23 b(directi)n(v)o(es)722 1602 y(specify)i(actions)h(that)g
(occur)f(at)h(compile)f(time.)42 b(Other)25 b(directi)n(v)o(es)g
(represent)f(comple)o(x)722 1702 y(operations)30 b(that)i(require)e
(the)i(generation)d(of)j(multiple)f(instructions.)58
b(The)31 b Fi(.local)722 1802 y Fk(directi)n(v)o(e,)19
b(for)h(e)o(xample,)e(declares)i(a)g(named)g(v)n(ariable.)822
2017 y Fi(.local)49 b(string)f(hello)639 2233 y Fh(\017)41
b Fg(Literals)822 2416 y(\226)g(Numbers)905 2532 y Fk(Inte)o(gers)18
b(and)i(\003oating)f(point)g(numbers)f(are)h(numeric)g(literals.)25
b(The)o(y)19 b(can)g(be)h(posi-)905 2632 y(ti)n(v)o(e)g(or)g(ne)o(gati)
n(v)o(e.)j(Inte)o(ger)18 b(literals)j(can)f(also)g(be)h(binary)-5
b(,)18 b(octal,)i(or)g(he)o(xadecimal:)1005 2798 y Fi($I0)49
b(=)g(42)349 b(#)49 b(positive)1005 2897 y($I1)g(=)g(-1)349
b(#)49 b(negative)1005 2997 y($I1)g(=)g(0b01010)99 b(#)49
b(binary)1005 3097 y($I2)g(=)g(0o72)249 b(#)49 b(octal)1005
3196 y($I3)g(=)g(0xA5)249 b(#)49 b(hexadecimal)905 3362
y Fk(Floating)24 b(point)g(number)f(literals)i(ha)n(v)o(e)f(a)h
(decimal)f(point)g(and)g(can)g(use)h(scienti\002c)905
3462 y(notation:)1005 3628 y Fi($N0)49 b(=)g(3.14)1005
3728 y($N2)g(=)g(-1.2e+4)822 3894 y Fg(\226)41 b(Strings)905
4010 y Fk(String)25 b(literals)h(are)g(enclosed)e(in)i(single)f(or)g
(double-quotes.)38 b(Strings)26 b(in)f(double-)905 4110
y(quotes)c(allo)n(w)g(escape)g(sequences)f(using)h(backslashes.)28
b(Strings)21 b(in)g(single-quotes)905 4209 y(only)e(allo)n(w)h(escapes)
h(for)e(nested)h(quotes)1005 4375 y Fi($S0)49 b(=)g("This)g(is)h(a)f
(valid)g(literal)g(string")1005 4475 y($S1)g(=)g('This)g(is)h(also)f(a)
g(valid)g(literal)g(string')639 4658 y Fh(\017)41 b Fg(V)-8
b(ariables)722 4790 y Fk(PIR)23 b(v)n(ariables)e(can)g(store)h(four)e
(dif)n(ferent)g(kinds)h(of)h(v)n(aluesinte)o(gers,)e(numbers)g
(\(\003oating)722 4890 y(point\),)h(strings,)g(and)g(objects.)28
b(P)o(arrot')-5 b(s)21 b(objects)g(are)g(called)h(PMCs,)g(for)f
(\224PolyMorphic)722 4990 y(Container\224.)p eop end
%%Page: 5 5
TeXDict begin 5 4 bop 722 523 a Fk(The)22 b(simplest)g(kind)g(of)f(v)n
(ariable)g(is)i(a)g(re)o(gister)e(v)n(ariable.)30 b(The)21
b(name)h(of)g(a)g(re)o(gister)f(v)n(ari-)722 623 y(able)27
b(al)o(w)o(ays)g(starts)g(with)g(a)g(dollar)e(sign)i(\()p
Fi($)p Fk(\),)g(follo)n(wed)e(by)i(a)f(single)h(character)e(which)722
722 y(speci\002es)h(the)e(type)h(of)f(the)h(v)n(ariable)f(\226)g(inte)o
(ger)g(\()p Fi(I)p Fk(\),)g(number)f(\()p Fi(N)p Fk(\),)h(string)h(\()p
Fi(S)p Fk(\),)f(or)h(PMC)722 822 y(\()p Fi(P)p Fk(\))18
b(\226)g(and)f(ends)h(with)g(a)g(unique)f(number)-5 b(.)23
b(Y)-9 b(ou)17 b(need)g(not)h(predeclare)e(re)o(gister)h(v)n(ariables:)
822 1038 y Fi($S0)49 b(=)h("Who's)e(a)i(pretty)f(boy,)g(then?")822
1137 y(say)g($S0)722 1353 y Fk(PIR)30 b(also)g(has)f(named)f(v)n
(ariables;)33 b(the)c Fi(.local)g Fk(directi)n(v)o(e)f(declares)h
(them.)51 b(As)30 b(with)722 1453 y(re)o(gister)18 b(v)n(ariables,)f
(there)h(are)g(four)f(v)n(alid)h(types:)24 b Fi(int)p
Fk(,)18 b Fi(num)p Fk(,)h Fi(string)p Fk(,)e(and)h Fi(pmc)p
Fk(.)24 b(Y)-9 b(ou)722 1553 y(must)17 b(declare)f(named)f(v)n
(ariables;)i(otherwise)f(the)o(y)g(beha)n(v)o(e)f(e)o(xactly)h(the)g
(same)h(as)g(re)o(gister)722 1652 y(v)n(ariables.)822
1868 y Fi(.local)49 b(string)f(hello)822 1968 y(hello)h(=)g("'Allo,)g
('allo,)g('allo.")822 2067 y(say)g(hello)639 2283 y Fh(\017)41
b Fg(Constants)722 2416 y Fk(The)22 b Fi(.const)f Fk(directi)n(v)o(e)g
(declares)g(a)i(named)d(constant.)30 b(Named)21 b(constants)h(are)f
(similar)722 2516 y(to)g(named)e(v)n(ariables,)h(b)n(ut)g(the)g(v)n
(alues)g(set)i(in)e(the)h(declaration)d(may)i(ne)n(v)o(er)f(change.)25
b(Lik)o(e)722 2615 y Fi(.local)p Fk(,)g Fi(.const)e Fk(tak)o(es)i(a)g
(type)f(and)f(a)i(name.)36 b(It)25 b(also)g(requires)e(a)h(literal)h
(ar)o(gument)722 2715 y(to)c(set)g(the)f(v)n(alue)f(of)h(the)g
(constant.)822 2931 y Fi(.const)49 b(int)198 b(frog)49
b(=)h(4)1146 b(#)49 b(integer)822 3030 y(.const)g(string)f(name)h(=)h
("Superintendent)d(Parrot")i(#)g(string)822 3130 y(.const)g(num)198
b(pi)149 b(=)50 b(3.14159)846 b(#)49 b(floating)f(point)722
3346 y Fk(Y)-9 b(ou)27 b(may)g(use)h(a)f(named)g(constant)f(an)o
(ywhere)g(you)g(may)h(use)h(a)f(literal,)j(b)n(ut)d(you)g(must)722
3445 y(declare)20 b(the)g(named)f(constant)g(beforehand.)639
3611 y Fh(\017)41 b Fg(K)n(eys)722 3744 y Fk(A)21 b(k)o(e)o(y)f(is)i(a)
f(special)g(kind)f(of)g(constant)g(used)g(for)g(accessing)g(elements)h
(in)f(comple)o(x)f(v)n(ari-)722 3844 y(ables)26 b(\(such)g(as)g(an)g
(array\).)40 b(A)27 b(k)o(e)o(y)e(is)i(either)e(an)h(inte)o(ger)f(or)g
(a)h(string;)j(and)c(it')-5 b(s)27 b(al)o(w)o(ays)722
3944 y(enclosed)d(in)h(square)f(brack)o(ets)g(\()p Fi([)h
Fk(and)f Fi(])p Fk(\).)38 b(Y)-9 b(ou)25 b(do)f(not)g(ha)n(v)o(e)g(to)h
(declare)f(literal)h(k)o(e)o(ys.)722 4043 y(This)h(code)f(e)o(xample)f
(stores)i(the)g(string)f Fi("foo")g Fk(in)h Fi($P0)f
Fk(as)i(element)e Fi(5)p Fk(,)i(and)e(then)g(re-)722
4143 y(trie)n(v)o(es)20 b(it.)822 4359 y Fi($P0[5])49
b(=)g("foo")822 4458 y($S1)199 b(=)49 b($P0[5])722 4674
y Fk(PIR)21 b(supports)e(multi-part)g(k)o(e)o(ys.)25
b(Use)c(a)f(semicolon)f(to)i(separate)e(each)h(part.)822
4890 y Fi($P0['my';'key'])47 b(=)j(472)822 4990 y($I1)647
b(=)50 b($P0['my';'key'])p eop end
%%Page: 6 6
TeXDict begin 6 5 bop 639 523 a Fh(\017)41 b Fg(Contr)o(ol)19
b(Structur)o(es)822 704 y(\226)41 b(goto)905 820 y Fk(The)28
b Fi(goto)49 b(label)28 b Fk(statement)f(jumps)h(to)g(a)h(named)e
(label.)49 b(It)28 b(can)g(only)f(jump)905 919 y(inside)20
b(a)h(subroutine,)d(and)h(only)h(to)g(a)h(named)e(label.)25
b(Example:)1104 1084 y Fi(goto)49 b(GREET)1204 1183 y(#)g(...)h(some)f
(skipped)f(code)h(...)1005 1283 y(GREET:)1104 1382 y(say)g("'Allo,)g
('allo,)g('allo.")822 1547 y Fg(\226)41 b(if)905 1662
y Fk(V)-9 b(ariations)23 b(on)h(the)f(basic)h Fi(goto)g
Fk(check)f(whether)g(a)h(particular)f(condition)f(is)j(true)905
1762 y(or)20 b(f)o(alse)h(before)d(jumping:)1005 1926
y Fi(if)49 b($I0)g(>)h(5)g(goto)f(GREET)639 2107 y Fh(\017)41
b Fg(Subr)o(outines)722 2239 y Fk(A)23 b(PIR)f(subroutine)e(starts)j
(with)f(the)g Fi(.sub)g Fk(directi)n(v)o(e)f(and)g(ends)h(with)g(the)g
Fi(.end)f Fk(direc-)722 2339 y(ti)n(v)o(e.)52 b(P)o(arameter)28
b(declarations)g(use)h(the)g Fi(.param)g Fk(directi)n(v)o(e;)j(the)o(y)
c(resemble)h(named)722 2439 y(v)n(ariable)19 b(declarations.)722
2571 y(This)30 b(e)o(xample)f(declares)g(a)h(subroutine)e(named)h
(greeting,)i(that)f(tak)o(es)g(a)g(single)g(string)722
2671 y(parameter)19 b(named)g Fi(hello)p Fk(:)822 2883
y Fi(.sub)49 b('greeting')1021 2983 y(.param)g(string)g(hello)1021
3082 y(say)g(hello)822 3182 y(.end)515 3461 y Fl(3)119
b(The)30 b(Phases)g(of)f(a)h(T)-9 b(ranslator)515 3647
y Fk(The)24 b(code)h(belo)n(w)f(\(\002le)i Fi(infix2pir.pl)p
Fk(\))d(displays)i(the)g(stages)g(of)g(the)g(translator:)34
b Fj(Le)n(xical)515 3747 y(and)21 b(syntax)h(analysis,)g(tr)m(ee)g(tr)o
(ansformations)f(and)g(decor)o(ations,)g(addr)m(ess)h(assignments,)f
(code)515 3846 y(g)o(ener)o(ation)g(and)h(peephole)f(optimization)p
Fk(.)32 b(The)22 b(simplicity)h(of)f(the)h(considered)e(language)g
(\(no)515 3946 y(types,)k(no)f(control)g(structures\))g(permits)g(the)h
(skipping)e(of)h Fj(conte)n(xt)h(handling)d Fk(\(also)j(called)f
Fj(se-)515 4046 y(mantic)c(analysis)p Fk(\).)27 b(Conte)o(xt)21
b(handling)e(includes)h(jobs)h(lik)o(e)g Fj(type)g(c)o(hec)n(king)p
Fk(,)f Fj(live)i(analysis)p Fk(,)e(etc.)515 4145 y(Don')o(t)g(get)h(o)o
(v)o(er\003o)n(wed)e(for)i(so)h(much)f(terminology:)k(The)c(incoming)f
(sections)h(will)h(e)o(xplain)e(in)515 4245 y(more)f(detail)h(each)g
(of)g(these)g(phases.)515 4408 y Fi(my)49 b($filename)f(=)i(shift;)515
4508 y(my)f($parser)g(=)g(Infix->new\(\);)515 4707 y(#)g(read)g(input)
515 4807 y($parser->slurp_file\($filename\);)515 5006
y(#)g(lexical)g(and)g(syntax)g(analysis)p eop end
%%Page: 7 7
TeXDict begin 7 6 bop 515 523 a Fi(my)49 b($t)h(=)f
($parser->YYParse\(\);)515 722 y(#)g(tree)g(transformations:)515
822 y(#)g(machine)g(independent)f(optimizations)515 922
y($t->s\(our)g(@algebra\);)515 1121 y(#)h(Address)g(Assignment)515
1220 y(our)g($reg_assign;)515 1320 y($reg_assign->s\($t\);)515
1519 y(#)g(Translate)f(to)i(PARROT)515 1619 y($t->bud\(our)d
(@translation\);)515 1818 y(#)i(variable)g(declarations)515
1918 y(my)g($dec)g(=)h(build_dec\(\);)515 2117 y
(peephole_optimization\($t->{tr}\);)515 2316 y
(output_code\(\\$t->{tr},)45 b(\\$dec\);)639 2482 y Fk(The)32
b(compiler)f(uses)i(the)f(parser)g(for)g(in\002x)g(e)o(xpressions)f
(that)i(w)o(as)g(generated)d(from)i(the)515 2582 y(Eyapp)19
b(grammar)f Fi(Infix.eyp)h Fk(\(see)i(section)f(5\))f(using)h(the)g
(command:)515 2748 y Fi($)49 b(eyapp)g(Infix.eyp)515
2847 y($)g(ls)h(-tr)f(|)h(tail)f(-1)515 2947 y(Infix.pm)515
3113 y Fk(It)28 b(also)h(uses)f(the)h(module)d(containing)h(dif)n
(ferent)f(f)o(amilies)i(of)g(tree)h(transformations)c(that)k(are)515
3212 y(described)19 b(in)h(the)g Fi(I2PIR.trg)f Fk(\002le)i(\(e)o
(xplained)d(in)i(sections)h(6)f(and)g(8\):)515 3378 y
Fi($)49 b(treereg)g(-m)g(main)g(I2PIR.trg)515 3478 y($)g(ls)h(-tr)f(|)h
(tail)f(-1)515 3578 y(I2PIR.pm)515 3677 y($)g(head)g(-1)h(I2PIR.pm)515
3777 y(package)e(main;)515 3943 y Fk(The)15 b(option)g
Fi(-m)49 b(main)16 b Fk(tells)g Fi(treereg)f Fk(to)h(place)g(the)f
(generated)f(tree)i(transformations)e(inside)515 4042
y(the)24 b Fi(main)g Fk(namespace.)36 b(Is)25 b(in)f(this)h(\002le)g
(that)f(the)h(v)n(ariables)e Fi(@algebra)p Fk(,)h Fi(@translation)515
4142 y Fk(and)19 b Fi($reg_assign)g Fk(used)h(during)e(the)i
(machine-independent)c(optimization,)i(code)h(genera-)515
4242 y(tion)h(and)f(re)o(gister)h(allocation)f(phases)h(are)g
(de\002ned.)515 4522 y Fl(4)119 b(Lexical)30 b(Analysis)515
4707 y Fk(Le)o(xical)f(Analysis)i(decomposes)e(the)h(input)g(stream)g
(in)h(a)g(sequence)e(of)h(le)o(xical)g(units)h(called)515
4807 y Fj(tok)o(ens)p Fk(.)55 b(Associated)30 b(with)h(each)f(tok)o(en)
g(is)h(its)g Fj(attrib)n(ute)g Fk(which)e(carries)i(the)f
(corresponding)515 4907 y(information.)53 b(Each)29 b(time)i(the)f
Fj(par)o(ser)j Fk(requires)c(a)i(ne)n(w)f(tok)o(en,)i(the)e(le)o(x)o
(er)g(returns)f(the)h(cou-)515 5006 y(ple)g Fi(\(token,)49
b(attribute\))29 b Fk(that)h(matched.)54 b(When)30 b(the)h(end)f(of)g
(input)f(is)j(reached)d(the)p eop end
%%Page: 8 8
TeXDict begin 8 7 bop 515 523 a Fk(le)o(x)o(er)24 b(returns)g(the)h
(couple)f Fi(\('',)49 b(undef\))p Fk(.)38 b(Y)-9 b(ou)25
b(don')o(t)e(ha)n(v)o(e)h(to)i(write)f(a)g(le)o(xical)g(analyzer:)515
623 y(P)o(arse::Eyapp)18 b(automatically)h(generates)g(one)g(for)g(you)
h(using)f(your)g Fi(\045token)g Fk(de\002nitions)g(\(\002le)515
722 y Fi(Infix.eyp)p Fk(\):)515 905 y Fi(\045token)48
b(NUM)149 b(=)50 b(/\([0-9]+\(?:\\.[0-9]+\)?\)/)515 1005
y(\045token)e(PRINT)h(=)h(/print\\b/)515 1104 y(\045token)e(VAR)149
b(=)50 b(/\([A-Za-z_][A-Za-z0-9_])2412 1119 y(*)2462
1104 y(\)/)639 1287 y Fk(Here)20 b(the)f(order)g(is)i(important.)i(The)
c(re)o(gular)f(e)o(xpression)g(for)h Fi(PRINT)h Fk(will)g(be)g(tried)f
(before)515 1386 y(the)e(re)o(gular)f(e)o(xpression)g(fo)h
Fi(VAR)p Fk(.)h(The)f(parenthesis)g(are)g(also)h(important.)k(The)c(le)
o(xical)f(analyzer)515 1486 y(b)n(uilt)24 b(from)f(the)h(re)o(gular)e
(e)o(xpression)g(for)h Fi(VAR)h Fk(returns)f Fi(\('VAR'.)49
b($1\))p Fk(.)36 b(Be)24 b(sure)g(your)f(\002rst)515
1586 y(memory)18 b(parenthesis)h(holds)h(the)g(desired)g(attrib)n(ute.)
639 1685 y(The)25 b(le)o(xical)f(analyzer)g(can)h(also)g(be)g
(speci\002ed)g(through)d(the)j Fi(\045lexer)g Fk(directi)n(v)o(e)e
(\(see)j(the)515 1785 y(head)f(section)h(in)h(\002le)g
Fi(InfixWithLexerDirective.eyp)22 b Fk(of)k(the)g Fi(Parse::Eyapp)515
1885 y Fk(distrib)n(ution\).)42 b(The)26 b(directi)n(v)o(e)f
Fi(\045lexer)h Fk(is)h(follo)n(wed)f(by)g(the)g(code)g(of)g(the)h(le)o
(xical)f(analyzer)-5 b(.)515 1984 y(Inside)18 b(such)g(code)g(the)g(v)n
(ariable)f Fi($_)i Fk(contains)f(the)g(input)g(string.)24
b(The)18 b(special)h(v)n(ariable)e Fi($self)515 2084
y Fk(refers)i(to)i(the)f(parser)f(object.)25 b(The)19
b(pair)h Fi(\('',)49 b(undef\))20 b Fk(is)h(returned)d(by)i(the)g
(generated)f(le)o(x)o(er)515 2183 y(when)g(the)i(end)e(of)h(input)g(is)
h(detected.)515 2366 y Fi(\045lexer)98 b({)565 2466 y(m{\\G[)48
b(\\t])1013 2481 y(*)1063 2466 y(}gc;)565 2565 y(m{\\G\(\\n\)+}gc)994
b(and)49 b($self->tokenline\($1)d(=\230)k(tr/\\n//\);)565
2665 y(m{\\G\([0-9]+\(?:\\.[0-9]+\)?\)}gc)194 b(and)49
b(return)g(\('NUM',)148 b($1\);)565 2765 y(m{\\Gprint}gc)994
b(and)49 b(return)g(\('PRINT',)f('PRINT'\);)565 2864
y(m{\\G\([A-Za-z_][A-Za-z0-9_])1865 2879 y(*)1915 2864
y(\)}gc)c(and)49 b(return)g(\('VAR',)148 b($1\);)565
2964 y(m{\\G\(.\)}gc)1094 b(and)49 b(return)g(\($1,)298
b($1\);)515 3064 y(})515 3246 y Fk(In)29 b(the)h(code)g(e)o(xample)e
(abo)o(v)o(e)h(the)h(attrib)n(ute)f(associated)h(with)g(tok)o(en)f
Fi(NUM)h Fk(is)h(its)g(numerical)515 3346 y(v)n(alue)c(and)h(the)h
(attrib)n(ute)f(associated)g(with)h(tok)o(en)e Fi(VAR)i
Fk(is)g(the)f(actual)h(string.)49 b(Some)28 b(tok)o(ens)515
3445 y(-)f(lik)o(e)g Fi(PRINT)f Fk(-)h(do)f(not)g(carry)g(an)o(y)g
(special)h(information.)42 b(In)26 b(such)h(cases,)h(just)g(to)e(k)o
(eep)h(the)515 3545 y(protocol)18 b(simple,)i(the)g(le)o(x)o(er)g
(returns)f(the)h(couple)f Fi(\(token,)49 b(token\))p
Fk(.)639 3645 y(When)20 b(feed)g(it)h(with)f(input)g
Fi(b)49 b(=)h(1)20 b Fk(the)h(le)o(x)o(er)e(will)i(produce)d(the)i
(sequence)1013 3827 y Fi(\(VAR,)49 b('b'\))g(\('=',)g('='\))g(\('NUM',)
f('1'\))h(\('',)g(undef\))639 4010 y Fk(Le)o(xical)31
b(analyzers)g(can)h(ha)n(v)o(e)f(a)i(non)e(ne)o(gligible)f(impact)h(in)
h(the)g(o)o(v)o(erall)f(performance.)515 4110 y(W)-7
b(ays)25 b(to)g(speed)f(up)g(this)h(stage)g(can)f(be)h(found)e(in)i
(the)f(w)o(orks)g(of)h(Simoes)f([5)o(])h(and)f(T)-7 b(ambouras)515
4209 y([6)o(].)515 4489 y Fl(5)119 b(Syntax)30 b(Analysis)515
4675 y Fk(The)e(code)g(belo)n(w)h(sho)n(ws)f(the)h(body)f(of)g(the)h
(grammar)e(\(\002le)i Fi(Infix.eyp)p Fk(\).)50 b(Eyapp)27
b(syntax)515 4775 y(v)o(ery)e(much)g(resembles)h(the)h(syntax)e(of)i
(old)f(cherished)f Fi(yacc)h Fk([7)o(].)44 b(An)26 b(Eyapp)f(program)f
(has)515 4874 y(three)c(parts:)27 b Fj(head)p Fk(,)20
b Fj(body)g Fk(and)h Fj(tail)p Fk(.)28 b(Each)20 b(part)h(is)h
(separated)e(from)g(the)h(former)f(by)g(the)h(symbol)515
4974 y Fi(\045\045)p Fk(.)k(The)18 b(head)h(section)g(contains)g
(declarations,)f(code)g(support)g(and)h(directi)n(v)o(es.)k(The)c
(grammar)p eop end
%%Page: 9 9
TeXDict begin 9 8 bop 515 523 a Fk(rules)20 b(describing)f(the)i
(language)e(-)h(and)g(the)h(semantic)f(actions)g(that)h(indicate)f(ho)n
(w)g(e)n(v)n(aluate)g(the)515 623 y(attrib)n(utes)29
b(associated)f(with)h(the)g(symbols)f(-)i(reside)e(in)h(the)g(body)f
(section.)51 b(The)28 b(tail)i(section)515 722 y(includes)25
b(Perl)i(code)e(that)i(gi)n(v)o(es)f(support)e(to)j(the)f(semantic)g
(actions.)43 b(Commonly)25 b(the)h(le)o(xical)515 822
y(analyzer)j(and)g(error)g(diagnostic)g(subroutines)g(go)g(there.)55
b(In)30 b(the)g(case)g(of)g Fi(eyapp)g Fk(the)g(le)o(xi-)515
922 y(cal)d(analyzer)f(is)i(usually)f(automatically)f(generated)f(from)
i(the)g(tok)o(en)f(de\002nitions)h(or)g(de\002ned)515
1021 y(through)20 b(a)j Fi(\045lexer)f Fk(directi)n(v)o(e)f(inside)i
(the)f(head)g(section.)32 b(Also,)23 b(for)f(most)h(cases,)g(there)f
(is)i(no)515 1121 y(need)19 b(to)i(o)o(v)o(erwrite)d(the)i(pro)o(vided)
e(def)o(ault)h Fi(error)h Fk(diagnostic)f(method.)515
1303 y Fi(\045right)98 b('=')398 b(#)50 b(Head)f(section)515
1403 y(\045left)148 b('-')49 b('+')515 1503 y(\045left)148
b(')963 1518 y(*)1013 1503 y(')49 b('/')515 1602 y(\045left)148
b(NEG)515 1702 y(\045tree)515 1901 y(\045\045)515 2001
y(line:)646 b(#)50 b(Body)f(section)614 2100 y(sts)h(<\045name)e(EXPS)h
(+)h(';'>)515 2200 y(;)515 2300 y(sts:)714 2399 y(\045name)f(PRINT)714
2499 y(PRINT)g(leftvalue)614 2599 y(|)h(exp)515 2698
y(;)515 2798 y(exp:)714 2897 y(\045name)f(NUM)199 b(NUM)614
2997 y(|)50 b(\045name)f(VAR)199 b(VAR)614 3097 y(|)50
b(\045name)f(ASSIGN)g(leftvalue)f('=')h(exp)614 3196
y(|)h(\045name)f(PLUS)149 b(exp)49 b('+')g(exp)614 3296
y(|)h(\045name)f(MINUS)99 b(exp)49 b('-')g(exp)614 3396
y(|)h(\045name)f(TIMES)99 b(exp)49 b(')1611 3411 y(*)1661
3396 y(')g(exp)614 3495 y(|)h(\045name)f(DIV)199 b(exp)49
b('/')g(exp)614 3595 y(|)h(\045name)f(NEG)1312 3694 y('-')g(exp)697
b(\045prec)49 b(NEG)614 3794 y(|)648 b('\(')49 b(exp)g('\)')515
3894 y(;)515 3993 y(leftvalue)f(:)h(\045name)g(VAR)h(VAR)515
4093 y(;)515 4193 y(\045\045)515 4430 y Ff(5.1)99 b(Ambiguities)25
b(and)g(Con\003icts)515 4586 y Fk(The)e(former)g(grammar)f(is)j
(ambiguous.)34 b(F)o(or)23 b(instance,)i(an)f(e)o(xpression)e(lik)o(e)i
Fi(exp)49 b('-')h(exp)515 4686 y Fk(follo)n(wed)19 b(by)g(a)i(minus)f
Fi('-')g Fk(can)g(be)g(w)o(ork)o(ed)f(in)h(more)g(than)g(one)f(w)o(ay)
-5 b(.)25 b(An)20 b(e)o(xpression)f(lik)o(e:)1262 4868
y Fi(4)50 b(-)f(3)h(-)f(1)p eop end
%%Page: 10 10
TeXDict begin 10 9 bop 639 523 a Fk(Is)23 b(ambiguous.)29
b(If)22 b(you)f(can')o(t)h(see)g(it,)i(it)f(is)g(because)e(after)h(so)h
(man)o(y)e(years)h(in)g(school,)g(your)515 623 y(mind)d(has)i(ruled)f
(out)g(one)f(of)i(the)f(interpretations.)k(T)-7 b(w)o(o)20
b(interpretations)f(of)h(the)g(former)f(phrase)515 722
y(are:)1262 880 y Fi(\(4)49 b(-)h(3\))f(-)h(1)1262 979
y(4)g(-)f(\(3)h(-)f(1\))515 1137 y Fk(In)20 b(our)f(planet)h(the)g
(\002rst)h(interpretation)d(is)j(preferred)d(o)o(v)o(er)h(the)h
(second.)639 1236 y(If)c(we)g(ha)n(v)o(e)g(an)f(input)h(lik)o(e)g
Fi(NUM)49 b(-)h(NUM)f(-)g(NUM)16 b Fk(the)g(acti)n(vity)g(of)f(a)i
(LALR\(1\))e(parser)g(\(the)515 1336 y(f)o(amily)23 b(of)h(parsers)g
(to)g(which)g(Eyapp)f(belongs\))f(consists)j(of)f(a)g(sequence)f(of)h
Fj(shift)h(and)e(r)m(educe)515 1436 y(actions)p Fk(:)639
1607 y Fh(\017)41 b Fk(A)21 b Fj(shift)g(action)e Fk(has)i(as)f
(consequence)e(the)j(reading)d(of)i(the)g(ne)o(xt)g(tok)o(en.)639
1769 y Fh(\017)41 b Fk(A)29 b Fj(r)m(educe)e(action)h
Fk(is)h(\002nding)e(a)h(production)e(rule)i(that)g(matches)g(and)f
(substituting)h(the)722 1869 y Fj(right)21 b(hand)d(side)j
Fk(\(rhs\))e(of)h(the)g(production)e(by)i(the)41 b Fj(left)21
b(hand)d(side)j Fk(\(lhs\).)639 2041 y(F)o(or)k(input)f
Fi(NUM)49 b(-)g(NUM)h(-)f(NUM)25 b Fk(the)g(acti)n(vity)f(will)h(be)g
(as)g(follo)n(ws)g(\(the)f(dot)g(is)i(used)e(to)515 2140
y(indicate)19 b(where)h(the)g(ne)o(xt)g(input)f(tok)o(en)g(is\):)515
2312 y Fi(.NUM)49 b(-)g(NUM)h(-)f(NUM)h(#)f(shift)565
2412 y(NUM.-)f(NUM)i(-)f(NUM)h(#)f(reduce)g(exp:)g(NUM)565
2511 y(exp.-)f(NUM)i(-)f(NUM)h(#)f(shift)565 2611 y(exp)g(-.NUM)g(-)g
(NUM)h(#)f(shift)565 2710 y(exp)g(-)g(NUM.-)g(NUM)h(#)f(reduce)g(exp:)g
(NUM)565 2810 y(exp)g(-)g(exp.-)g(NUM)h(#)f(shift/reduce)f(conflict)515
2982 y Fk(up)20 b(to)g(this)h(point)e(tw)o(o)h(dif)n(ferent)f
(decisions)h(can)g(be)g(tak)o(en:)25 b(the)20 b(ne)o(xt)f(description)g
(can)h(be)565 3139 y Fi(exp.-)48 b(NUM)i(#)f(reduce)g(by)g(exp:)h(exp)f
('-')g(exp)515 3297 y Fk(or:)565 3454 y Fi(exp)g(-)g(exp)h(-.NUM)f(#)g
(shift)g('-')515 3611 y Fk(that)22 b(is)g(called)g(a)g
Fj(shift-r)m(educe)f(con\003ict)p Fk(:)28 b(the)22 b(parser)f(must)h
(decide)f(whether)g(to)h(shift)g Fi(NUM)g Fk(or)f(to)515
3711 y Fj(r)m(educe)h Fk(by)g(the)g(rule)g Fi(exp:)49
b(exp)h(-)f(exp)p Fk(.)32 b(A)23 b(shift-reduce)e(con\003ict)h(means)g
(that)h(the)f(parser)515 3811 y(is)c(not)f(in)g(condition)f(to)h
(decide)f(whether)h(to)g(associate)g(the)h(processed)e(phrase)g(\(left)
h(association\))515 3910 y(or)i(to)h(continue)e(reading)g(more)g(input)
h(to)h(mak)o(e)f(an)g(association)g(later)h(\(right)f(association\).)k
(This)515 4010 y(incapability)h(usually)g(comes)h(from)f(the)h(f)o(act)
h(that)f(the)g(grammar)f(is)i(ambiguous)d(b)n(ut)i(can)g(also)515
4110 y(be)f(due)f(to)h(other)g(reasons,)g(as)h(the)f(myopic)f
(condition)f(of)i(the)g(parser)m(,)g(being)f(able)h(only)f(to)h(see)515
4209 y(one)19 b(tok)o(en)h(ahead.)639 4309 y(Another)k(kind)g(of)h
(con\003icts)g(are)g Fj(r)m(educe-r)m(educe)e(con\003icts)p
Fk(.)39 b(The)o(y)23 b(arise)j(when)e(more)g(that)515
4408 y(rhs)c(can)g(be)g(applied)f(for)h(a)g(reduction)f(action.)639
4508 y(The)j(precedence)e(declarations)h(in)i(the)f(head)f(section)h
(tells)i(the)e(parser)f(what)i(to)f(do)g(in)g(case)515
4608 y(of)e(ambiguity)-5 b(.)639 4707 y(By)26 b(associating)f
(priorities)g(with)h(tok)o(ens)f(the)g(programmer)e(can)i(tell)i(Eyapp)
d(what)h(syntax)515 4807 y(tree)20 b(to)g(b)n(uild)g(in)g(case)h(of)f
Fj(con\003ict)p Fk(.)639 4907 y(The)k(declarations)g
Fi(\045nonassoc)p Fk(,)g Fi(\045left)g Fk(and)g Fi(\045right)g
Fk(declare)g(and)g(associate)h(a)f Fj(pri-)515 5006 y(ority)c
Fk(with)h(the)f(tok)o(ens)g(that)g(follo)n(w)f(them.)p
eop end
%%Page: 11 11
TeXDict begin 11 10 bop 639 523 a Fh(\017)41 b Fk(T)-7
b(ok)o(ens)20 b(declared)f(in)h(the)g(same)h(line)f(ha)n(v)o(e)g(the)g
(same)g(precedence.)639 688 y Fh(\017)41 b Fk(T)-7 b(ok)o(ens)18
b(declared)e(in)i(lines)h(belo)n(w)e(ha)n(v)o(e)g(more)g(precedence)f
(than)h(those)h(declared)e(abo)o(v)o(e.)639 852 y Fh(\017)41
b Fk(The)15 b(precedence)e(of)i(a)h(rhs)f(is)i(the)e(precedence)e(of)i
(the)g(rightmost)g(tok)o(en)f(in)i(that)f(rhs.)23 b(Thus,)722
952 y(the)c(production)c(named)i Fi(MINUS)p Fk(:)h Fi(exp)50
b(->)f(exp)g('-')h(exp)18 b Fk(has)g(the)h(precedence)d(of)722
1051 y Fi('-')p Fk(.)639 1216 y Fh(\017)41 b Fk(W)-7
b(e)21 b(can)f(al)o(w)o(ays)g(gi)n(v)o(e)f(an)g(e)o(xplicit)g(priority)
g(to)h(a)g(rhs)f(using)g(the)h Fi(\045prec)49 b(TOKEN)19
b Fk(direc-)722 1316 y(ti)n(v)o(e,)h(lik)o(e)g(in)h(the)f(rhs)g(named)f
Fi(NEG)p Fk(:)822 1511 y Fi(|)50 b(\045name)e(NEG)1220
1611 y('-')i(exp)f(\045prec)g(NEG)515 1807 y Fk(When)22
b(there)g(is)i(a)f(shift-reduce)d(con\003ict)j(the)f(precedence)f(of)h
(the)h(rule)f(and)g(the)g(precedence)f(of)515 1906 y(the)f(incoming)e
(tok)o(en)i(are)g(compared)639 2069 y Fh(\017)41 b Fk(If)20
b(the)h(precedence)d(of)i(the)g(rule)g(is)h(greater)m(,)d(a)j
(reduction)d(\(left)i(association\))g(tak)o(es)g(place)639
2234 y Fh(\017)41 b Fk(If)20 b(the)h(precedence)d(of)i(the)g(tok)o(en)f
(is)i(greater)m(,)e(a)i(shift)f(\(right)f(association\))h(tak)o(es)g
(place)639 2399 y Fh(\017)41 b Fk(If)27 b(both)g(tok)o(en)f(and)g(rule)
h(ha)n(v)o(e)g(the)g(same)g(precedence)e(the)i(parser)g(action)f
(depends)g(on)722 2498 y(whether)18 b(the)g(declaration)f(w)o(as)i
(made)f(using)g(the)g Fi(\045left)g Fk(or)g Fi(\045right)g
Fk(directi)n(v)o(e.)23 b(In)c(the)722 2598 y(\002rst)i(case)g(the)f
(reduction)e(tak)o(es)j(place,)f(in)g(the)g(second)f(the)i(shift)f
(predominates.)515 2761 y(Thus,)k(in)g(the)g(e)o(xample)f(we)h(are)g
(saying)f(that)i Fi('+')f Fk(and)f Fi('-')h Fk(ha)n(v)o(e)f(the)h(same)
h(precedence)d(b)n(ut)515 2861 y(higher)g(than)i Fi('=')p
Fk(.)36 b(The)24 b(\002nal)g(ef)n(fect)g(of)f Fi('-')h
Fk(ha)n(ving)f(greater)g(precedence)f(than)i Fi('=')g
Fk(is)g(that)515 2960 y(an)c(e)o(xpression)e(lik)o(e)j
Fi(a=4-5)f Fk(is)h(interpreted)d(as)j Fi(a=\(4-5\))f
Fk(and)f(not)h(as)h Fi(\(a=4\)-5)p Fk(.)639 3060 y(The)f(use)g(of)g
Fi(\045left)g Fk(applied)f(to)h Fi('-')g Fk(indicates)g(that,)g(in)g
(case)h(of)f(ambiguity)e(and)i(a)g(match)515 3160 y(between)j
(precedences,)h(the)g(parser)g(must)g(b)n(uild)g(the)g(tree)h
(corresponding)c(to)j(a)h(left)g(parenthe-)515 3259 y(sization.)g
(Thus,)19 b Fi(4-5-9)h Fk(is)h(interpreted)d(as)j Fi(\(4-5\)-9)p
Fk(.)639 3359 y(As)j(w)o(as)f(said,)h(the)e Fi(\045prec)h
Fk(directi)n(v)o(e)e(can)i(be)f(used)h(when)f(a)h(rhs)g(is)g(in)m(v)n
(olv)o(ed)e(in)i(a)g(con\003ict)515 3458 y(and)31 b(has)h(no)f(tok)o
(ens)g(inside)h(or)f(it)i(has)e(b)n(ut)h(the)g(precedence)d(of)j(the)g
(last)g(tok)o(en)f(leads)h(to)g(an)515 3558 y(incorrect)14
b(interpretation.)21 b(A)16 b(rhs)f(can)h(be)f(follo)n(wed)f(by)h(an)h
(optional)e Fi(\045prec)49 b(token)15 b Fk(directi)n(v)o(e)515
3658 y(gi)n(ving)k(the)h(production)d(the)k(precedence)d(of)i(the)g
Fi(token)515 3837 y(exp:)148 b('-')50 b(exp)f(\045prec)g(NEG)g({)h
(-$_[1])e(})515 4016 y Fk(This)22 b(solv)o(es)g(the)g(con\003ict)g(in)g
Fi(-)50 b(NUM)f(-)h(NUM)22 b Fk(between)f Fi(\(-)50 b(NUM\))f(-)g(NUM)
23 b Fk(and)e Fi(-)50 b(\(NUM)515 4115 y(-)f(NUM\))p
Fk(.)20 b(Since)g Fi(NEG)h Fk(has)f(more)f(priority)g(than)h
Fi('-')g Fk(the)g(\002rst)h(interpretation)d(will)j(win.)515
4352 y Ff(5.2)99 b(Building)25 b(the)h(AST)515 4508 y
Fk(P)o(arse::Eyapp)k(f)o(acilitates)i(the)f(construction)f(of)h
(abstract)g(syntax)g(trees)h(\(AST\))f(through)f(the)515
4608 y Fi(\045tree)20 b Fk(directi)n(v)o(e.)k(Nodes)c(in)h(the)f(AST)h
(are)f(blessed)h(in)f(the)h(production)d Fi(name)p Fk(.)25
b(A)c(rhs)f(can)h(be)515 4707 y Fj(named)e Fk(using)g(the)h
Fi(\045name)49 b(IDENTIFIER)19 b Fk(directi)n(v)o(e.)24
b(F)o(or)19 b(each)h Fj(rhs)h(name)e Fk(a)i(class/package)515
4807 y(with)f(name)g Fi(IDENTIFIER)f Fk(is)i(created.)639
4907 y(Symbolic)30 b(tok)o(ens)f(\(lik)o(e)i Fi(NUM)f(PRINT)g
Fk(or)g Fi(VAR)p Fk(\))g(are)h(considered)d(by)i(def)o(ault)g
Fj(semantic)515 5006 y(tok)o(ens)p Fk(.)41 b(String)26
b(literals)g(\(lik)o(e)g Fi('+')p Fk(,)h Fi('/')p Fk(,)g(etc.\))41
b(are)26 b(-)g(unless)g(e)o(xplictly)f(declared)f(using)i(the)p
eop end
%%Page: 12 12
TeXDict begin 12 11 bop 515 523 a Fi(semantic)48 b(token)24
b Fk(directi)n(v)o(e)e(-)j(considered)d Fj(syntactic)h(tok)o(ens)p
Fk(.)37 b(When)23 b(b)n(uilding)g(the)h(AST)515 623 y(syntactic)k(tok)o
(ens)h(do)f(not)g(yield)h(ne)n(w)f(nodes.)50 b(Semantic)29
b(tok)o(ens)f(ho)n(we)n(v)o(er)f(ha)n(v)o(e)h(their)g(o)n(wn.)515
722 y(Thus)19 b(when)h(feed)f(with)h(input)f Fi(b=2)1574
737 y(*)1624 722 y(a)h Fk(the)g(generated)e(parser)h(produces)g(the)h
(follo)n(wing)e(AST)3323 692 y Fe(1)3356 722 y Fk(:)515
888 y Fi(\230/LEyapp/examples/ParsingStringsAn)o(dTree)o(s$)44
b(perl)49 b(-wd)g(infix2pir.pl)98 b(#)49 b(start)g(the)g(debugger)515
1088 y(Loading)f(DB)i(routines)e(from)h(perl5db.pl)f(version)h(1.31)515
1187 y(Editor)f(support)h(available.)515 1386 y(Enter)g(h)g(or)h(`h)f
(h')h(for)f(help,)g(or)g(`man)g(perldebug')f(for)h(more)g(help.)515
1586 y(main::\(infix2pir.pl:48\):)195 b(my)49 b($filename)f(=)i(shift;)
614 1685 y(DB<1>)f(l)h(48,55)746 b(#)50 b(let)f(us)g(see)h(the)f
(source)g(code)g(...)515 1785 y(48==>)148 b(my)50 b($filename)e(=)h
(shift;)515 1885 y(49:)g(my)g($parser)g(=)h(Infix->new\(\);)515
1984 y(50:)f($parser->slurp_file\($filename\);)515 2084
y(51)515 2183 y(52:)g(my)g($t)h(=)f($parser->YYParse\(\);)515
2283 y(53)515 2383 y(54)99 b(#)50 b(Machine)e(independent)g
(optimizations)515 2482 y(55:)h($t->s\(our)f(@algebra\);)614
2582 y(DB<2>)h(c)h(55)99 b(#)50 b(continue)e(until)h(the)g(abstract)g
(syntax)f(tree)h(\(AST\))g(is)h(built)515 2682 y(b)f(=)h(2)814
2697 y(*)913 2682 y(a)249 b(#)50 b(<-)f(user)g(input)515
2781 y(main::\(infix2pir.pl:55\):)195 b($t->s\(our)48
b(@algebra\);)614 2881 y(DB<3>)h(p)h($t->str)98 b(#)50
b(show)f(us)g(the)h(AST)515 2980 y
(line_3\(EXPS\(sts_5\(ASSIGN\(VAR\(TERMI)o(NAL[b)o(]\),TIM)o(ES\(NU)o
(M\(TER)o(MINAL[)o(2]\),V)o(AR\(TE)o(RMINAL)o([a]\)\))o(\)\)\)\))515
3147 y Fk(Nodes)31 b(of)f(the)i(AST)f(are)g(hashes)g(that)g(can)g(be)g
Fj(decor)o(ated)f Fk(with)h(ne)n(w)g(k)o(e)o(ys/attrib)n(utes.)57
b(The)515 3246 y(only)21 b(reserv)o(ed)f(\002eld)i(is)h
Fi(children)d Fk(which)i(is)g(a)h(reference)d(to)i(the)f(array)g(of)h
(children.)28 b(Nodes)515 3346 y(named)g Fi(TERMINAL)h
Fk(are)h(b)n(uilt)g(from)f(the)h(tok)o(ens)f(pro)o(vided)e(by)j(the)f
(le)o(xical)h(analyzer)-5 b(.)53 b(The)515 3445 y(couple)24
b Fi(\($token,)49 b($attribute\))24 b Fk(returned)g(by)h(the)h(le)o
(xical)f(analyzer)g(is)i(stored)e(under)515 3545 y(the)30
b(k)o(e)o(ys)h Fi(token)f Fk(and)g Fi(attr)p Fk(.)56
b Fi(TERMINAL)30 b Fk(nodes)g(also)h(ha)n(v)o(e)f(the)g(attrib)n(ute)g
Fi(children)515 3645 y Fk(which)25 b(is)i(set)f(to)g(an)g(anon)o(ymous)
d(empty)i(list.)42 b(Observ)o(e)25 b(the)h(absence)f(of)g
Fi(TERMINAL)g Fk(nodes)515 3744 y(corresponding)f(to)j(tok)o(ens)g
Fi('=')h Fk(and)e Fi(')1729 3759 y(*)1779 3744 y(')p
Fk(.)47 b(If)27 b(we)h(change)e(the)i(status)g(of)f Fi(')2862
3759 y(*)2912 3744 y(')g Fk(and)g Fi('=')g Fk(to)515
3844 y Fi(semantic)19 b Fk(using)h(the)g Fi(\045semantic)48
b(token)20 b Fk(directi)n(v)o(e:)515 4010 y Fi(1)149
b(\045semantic)48 b(token)h(')1561 4025 y(*)1611 4010
y(')g('=')515 4110 y(2)149 b(\045right)98 b('=')515 4209
y(3)149 b(....)99 b(etc.)515 4375 y Fk(we)20 b(get)h(a)f(-)h(concrete)d
(-)j(syntax)e(tree:)515 4541 y Fi(EXPS\()614 4641 y(ASSIGN\()714
4741 y(VAR\(TERMINAL[b]\),)714 4840 y(TERMINAL[=],)p
515 4902 1146 4 v 605 4958 a Fd(1)634 4981 y Fc(The)e(information)i
(between)g(brack)o(ets)h(sho)n(ws)d(the)g(attrib)o(ute)j(for)d
Fb(TERMINAL)e Fc(nodes)p eop end
%%Page: 13 13
TeXDict begin 13 12 bop 714 523 a Fi(TIMES\()814 623
y(NUM\(TERMINAL[2]\),)814 722 y(TERMINAL[)1264 737 y(*)1314
722 y(],)814 822 y(VAR\(TERMINAL[a]\))714 922 y(\))50
b(#)f(TIMES)614 1021 y(\))h(#)g(ASSIGN)515 1121 y(\))515
1277 y Fk(Let)20 b(us)h(no)n(w)e(consider)g(the)i(input)e
Fi(2)1568 1292 y(*)1618 1277 y(\(a+1\))p Fk(.)24 b(The)c(parser)g
(yields)g(the)g(tree:)515 1433 y Fi(EXPS\()614 1532 y(TIMES\()714
1632 y(NUM\()764 1732 y(TERMINAL[2]\),)764 1831 y(exp_14\()863
1931 y(PLUS\()963 2031 y(VAR\(TERMINAL[a]\),)963 2130
y(NUM\(TERMINAL[1]\)\))863 2230 y(\))50 b(#)g(PLUS)614
2329 y(\))g(#)g(TIMES)515 2429 y(\))515 2585 y Fk(T)-7
b(w)o(o)22 b(features)g(are)g(noticeable:)28 b(the)22
b(parenthesis)f(rule)h Fi(exp:)g('\(')49 b(exp)h('\)')22
b Fk(had)f(no)h(name)515 2685 y(and)h(got)h(automatically)e(one:)32
b Fi(exp_14)p Fk(.)k(The)24 b Fj(name)f(of)h(a)g(rhs)h
Fk(by)e(def)o(ault)g(results)i(from)d(con-)515 2784 y(catenating)29
b(the)i(left)g(hand)f(side)h(of)f(the)h(rule)f(with)h(the)g(ordinal)e
(number)g(of)i(the)f(rule)3139 2754 y Fe(2)3172 2784
y Fk(.)57 b(The)515 2884 y(second)19 b(is)i(that)f(node)g
Fi(exp_14)f Fk(is)i(useless)g(and)f(can)g(be)g(suppressed.)639
2984 y(The)15 b Fi(\045tree)g Fk(directi)n(v)o(e)f(can)h(be)g
(accompanied)e(of)i(the)g Fi(\045bypass)f Fk(clause.)24
b(A)16 b Fi(\045tree)48 b(bypass)515 3083 y Fk(produces)26
b(an)i(automatic)g Fj(bypass)g Fk(of)g(an)o(y)f(node)g(with)i(only)e
(one)h(child)g(at)h Fj(tr)m(ee-construction-)515 3183
y(time)p Fk(.)g(A)22 b Fj(bypass)f(oper)o(ation)f Fk(consists)i(in)g
Fj(r)m(eturning)e(the)i(only)f(c)o(hild)g(of)h(the)f(node)g(being)f
(visited)515 3282 y(to)25 b(the)g(father)g(of)h(the)f(node)f(and)g(r)m
(e-typing)g(\(r)m(e-blessing\))g(the)h(node)f(in)i(the)f(name)f(of)i
(the)f(pr)l(o-)515 3382 y(duction)766 3352 y Fe(3)797
3382 y Fk(.)639 3482 y(Changing)18 b(the)h(line)g Fi(\045tree)g
Fk(by)g Fi(\045tree)49 b(bypass)18 b Fk(in)h(\002le)h
Fi(Infix.eyp)e Fk(we)i(get)f(a)g(more)515 3581 y(suitable)h(AST)g(for)g
(input)f Fi(2)1330 3596 y(*)1380 3581 y(\(a+1\))p Fk(:)515
3751 y Fi(EXPS\(TIMES\(NUM[2],PLUS\(VAR[a],NUM[)o(1]\)\)\))639
3921 y Fk(The)27 b(node)f Fi(exp_14)g Fk(has)i(disapeared)d(in)j(this)f
(v)o(ersion)f(since)h(the)g Fj(bypass)g(oper)o(ation)e
Fk(ap-)515 4021 y(plies)20 b(to)g(the)f(rhs)h(of)f(the)h(rule)f
Fi(exp:)49 b('\(')h(exp)f('\)')p Fk(:)25 b(T)-7 b(ok)o(ens)19
b Fi('\(')h Fk(and)f Fi('\)')g Fk(are)h(syntactic)515
4121 y(tok)o(ens)31 b(and)h(therefore)f(at)h Fj(tr)m(ee)h(construction)
e(time)i Fk(only)e(one)h(child)g(is)h(left.)61 b(Observ)o(e)31
b(also)515 4220 y(the)g(absence)f(of)h Fi(TERMINAL)f
Fk(nodes.)56 b(Bypass)31 b(clearly)g(applies)f(to)h(rules)g
Fi(exp:)49 b(NUM)31 b Fk(and)515 4320 y Fi(exp:)49 b(VAR)22
b Fk(since)h(the)o(y)e(ha)n(v)o(e)h(only)g(one)g(element)f(on)h(their)g
(rhs.)32 b(Therefore)20 b(the)i Fi(TERMINAL)515 4420
y Fk(node)d(is)i(re-blessed)e(as)i Fi(NUM)f Fk(and)g
Fi(VAR)g Fk(respecti)n(v)o(ely)-5 b(.)639 4519 y(A)26
b(consequence)d(of)i(the)g(global)f(scope)h(application)f(of)h
Fi(\045tree)49 b(bypass)24 b Fk(is)j(that)e(unde-)515
4619 y(sired)20 b(bypasses)g(may)f(occur)-5 b(.)25 b(Consider)19
b(the)i(tree)f(rendered)e(for)h(input)h Fi(-a)2711 4634
y(*)2761 4619 y(2)p Fk(:)515 4789 y Fi(EXPS\(TIMES\(NEG,NUM\)\))p
515 4846 1146 4 v 605 4902 a Fd(2)634 4925 y Fc(As)d(it)g(appears)i(in)
e(the)h Fb(.output)d Fc(\002le.)21 b(The)c Fb(.output)f
Fc(\002le)h(can)h(be)f(generated)j(using)e(the)f Fb(-v)g
Fc(option)h(of)f Fb(eyapp)605 4983 y Fd(3)634 5006 y
Fc(If)g(the)h(production)h(has)e(an)h(e)o(xplicit)i(name.)h(Otherwise)d
(there)h(is)d(no)i(re-blessing)p eop end
%%Page: 14 14
TeXDict begin 14 13 bop 639 523 a Fk(What)24 b(happened?)34
b(The)24 b(bypass)f(is)i(applied)d(to)i(the)g(rhs)g Fi('-')49
b(exp)p Fk(.)36 b(Though)22 b(the)i(rhs)f(has)515 623
y(tw)o(o)d(symbols,)f(tok)o(en)g Fi('-')h Fk(is)h(a)g(syntactic)e(tok)o
(en)h(and)f(at)i Fj(tr)m(ee-construction-time)c Fk(only)j
Fi(exp)g Fk(is)515 722 y(left.)25 b(The)20 b Fj(bypass)g
Fk(operation)e(applies)i(when)g(b)n(uilding)f(this)i(node.)j(This)c
(undesired)f Fj(bypass)h Fk(can)515 822 y(be)g(a)n(v)n(oided)f
(applying)f(the)j Fi(no)49 b(bypass)20 b Fk(directi)n(v)o(e)f(to)h(the)
g(production:)565 1004 y Fi(exp)49 b(:)g(\045no)h(bypass)e(NEG)863
1104 y('-')i(exp)f(\045prec)g(NEG)515 1287 y Fk(No)n(w)20
b(the)g(AST)h(for)e Fi(-a)1212 1302 y(*)1262 1287 y(2)h
Fk(is)h(correct:)515 1453 y Fi(EXPS\(TIMES\(NEG\(VAR\),NUM\)\))639
1619 y Fk(Eyapp)e(pro)o(vides)g(operators)f Fi(+)p Fk(,)1599
1634 y Fi(*)1669 1619 y Fk(and)i Fi(?)g Fk(for)g(the)g(creation)f(of)h
(lists)i(and)d(optionals)h(as)h(in:)515 1785 y Fi(line:)49
b(sts)g(<EXPS)g(+)g(';'>)515 1950 y Fk(which)16 b(states)i(that)g(a)f
Fi(line)g Fk(is)h(made)e(of)h(a)h(non)e(empty)g(list)i(of)f
Fi(EXPS)g Fk(separated)f(by)h(semicolons.)515 2050 y(By)22
b(def)o(ault)f(the)g(class)i(name)e(for)g(such)h(list)g(is)h
Fi(_PLUS_LIST)p Fk(.)d(The)h Fi(\045name)h Fk(directi)n(v)o(e)e(can)i
(be)515 2150 y(used)e(to)g(modify)f(the)h(def)o(ault)f(name:)515
2316 y Fi(line:)49 b(sts)g(<\045name)g(EXPS)g(+)g(';'>)639
2482 y Fk(Explicit)21 b(actions)h(can)f(be)g(speci\002ed)h(by)f(the)g
(programmer)-5 b(.)27 b(The)o(y)20 b(are)i(managed)d(as)k(anon)o(y-)515
2581 y(mous)28 b(subroutines)e(that)j(recei)n(v)o(e)e(as)i(ar)o
(guments)d(the)j(attrib)n(utes)f(of)g(the)g(symbols)g(in)h(the)f(rule)
515 2681 y(and)d(are)g(e)o(x)o(ecuted)e(each)i(time)h(a)f
Fj(r)m(eduction)f Fk(by)h(that)h(rule)f(occurs.)39 b(When)25
b(running)f(under)g(the)515 2781 y Fi(\045tree)17 b Fk(directi)n(v)o(e)
f(this)h(pro)o(vides)f(a)i(mechanism)d(to)j(in\003uence)e(the)h(shape)g
(of)g(the)g(AST)-6 b(.)18 b(Observ)o(e)515 2880 y(ho)n(we)n(v)o(er)f
(that)i(the)h(grammar)d(in)j(the)f(e)o(xample)f(is)i(clean)p
1981 2894 176 4 v 19 w(of)f(actions:)25 b Fj(P)-7 b(ar)o(se::Eyapp)17
b(allowed)i(us)515 2980 y(to)h(pr)l(oduce)f(a)h(suitable)g(AST)g
(without)g(writing)h(any)e(e)n(xplicit)i(actions)p Fk(.)515
3260 y Fl(6)119 b(T)-9 b(r)n(ee)30 b(T)-9 b(ransf)m(ormations)515
3445 y Fk(Once)23 b(we)h(ha)n(v)o(e)f(the)h(AST)g(we)g(can)f(transform)
f(it)i(using)f(the)h Fj(T)-5 b(r)m(eer)m(e)m(g)o(e)n(xp)24
b Fk(language.)33 b(The)23 b(code)515 3545 y(belo)n(w)f(\(in)h(\002le)g
Fi(I2PIR.trg)p Fk(\))e(sho)n(ws)i(a)g(set)h(of)f(algebraic)e(tree)i
(transformations)e(whose)h(goal)515 3645 y(is)f(to)f(produce)e(machine)
h(independent)f(optimizations.)515 3811 y Fi({)49 b(#)100
b(Example)48 b(of)i(support)e(code)614 3910 y(use)i(List::Util)e
(qw\(reduce\);)614 4010 y(my)i(\045Op)f(=)h(\(PLUS=>'+',)d(MINUS)i(=>)h
('-',)f(TIMES=>')2758 4025 y(*)2808 4010 y(',)f(DIV)h(=>)g('/'\);)515
4110 y(})515 4309 y(algebra)f(=)i(fold)f(wxz)g(zxw)g(neg;)515
4508 y(fold:)g(/TIMES|PLUS|DIV|MINUS/:b\(NUM,)44 b(NUM\))49
b(=>)h({)614 4608 y(my)g($op)f(=)h($Op{ref\($b\)};)714
4707 y(croak)f("Unexpected)f(tree)h(shape:)f(".$_[0]->str.")g(can't)g
(find)i(number)e(in)i(the)f(expected)f(place\\n")614
4807 y(unless)h(exists)g(\($NUM[0]->{attr}\))d(&&)k(\($NUM[0]->{attr})d
(=\230)i(/\210\\d+/\);)614 5006 y($NUM[0]->{attr})e(=)j(eval)99
b("$NUM[0]->{attr})47 b($op)i($NUM[1]->{attr}";)p eop
end
%%Page: 15 15
TeXDict begin 15 14 bop 614 523 a Fi($_[0])49 b(=)h($NUM[0];)515
623 y(})515 822 y(zxw:)f(TIMES\(NUM,)f(.\))h(and)g({$NUM->{attr})f(==)h
(0})h(=>)f({)h($_[0])f(=)g($NUM)g(})515 1021 y(wxz:)g(TIMES\(.,)f
(NUM\))h(and)g({$NUM->{attr})f(==)h(0})h(=>)f({)h($_[0])f(=)g($NUM)g(})
515 1220 y(neg:)g(NEG\(NUM\))f(=>)i({)f($NUM->{attr})f(=)h
(-$NUM->{attr};)f($_[0])g(=)i($NUM)f(})515 1386 y Fk(A)22
b(T)m(reere)o(ge)o(xp)e(programs)g(is)j(made)e(of)h Fj(tr)m(eer)m(e)m
(g)o(e)n(xp)g Fk(rules)g(that)g(describe)f(what)h(subtrees)g(match)515
1486 y(and)d(ho)n(w)h(transform)f(them:)515 1652 y Fi(wxz:)49
b(TIMES\(.,)f(NUM\))h(and)g({$NUM->{attr}==0})e(=>)j({)f($_[0])g(=)h
($NUM)f(})515 1818 y Fk(This)20 b(rule)g(comes)g(to)g(say)722
1984 y(Where)n(v)o(er)30 b(you)h(\002nd)g(a)h(node)e(labelled)h
Fi(TIMES)g Fk(whose)h(right)f(child)g(is)h(a)g Fi(NUM)722
2084 y Fk(node)22 b(and)g(the)h(v)n(alue)f(of)g(such)h
Fi(NUM)g Fk(is)g(zero,)g Fj(whate)o(ver)f(the)h(left)g(c)o(hild)f
(subtr)m(ee)h(is)722 2183 y Fk(proceed)c(to)h(substitute)g(the)g(whole)
g(tree)g(by)g(its)h(right)f(child,)f(i.e.)26 b(by)19
b(zero.)639 2350 y(A)27 b(rule)f(has)h(a)g Fj(name)e
Fk(\()p Fi(wxz)h Fk(in)h(the)f(e)o(xample.)42 b Fi(wxz)27
b Fk(stands)f(for)g Fj(whate)o(ver)g(times)h(zer)l(o)p
Fk(\),)h(a)515 2449 y Fj(term)d Fk(describing)d(the)i(shape)g(of)g(the)
g(subtree)g(to)g(match)f Fi("TIMES\(.,)49 b(NUM\)")23
b Fk(and)h(tw)o(o)g(op-)515 2549 y(tional)h(\002elds:)37
b(a)26 b Fj(semantic)f(condition)f Fk(e)o(xpliciting)g(the)i(attrib)n
(ute)f(constraints)g(\(the)g(code)g(after)515 2648 y(the)16
b(reserv)o(ed)f(w)o(ord)g Fi(and)p Fk(\))h(and)g(some)g
Fj(tr)o(ansformation)e(code)i Fk(that)g(tells)h(ho)n(w)f(to)g(modify)f
(the)h(sub-)515 2748 y(tree)23 b(\(the)f(code)g(after)h(the)f(big)h
(arro)n(w)f Fi(=>)p Fk(\).)32 b(Each)23 b(rule)f(is)i(translated)e
(into)h(a)g(subroutine)3175 2718 y Fe(4)3231 2748 y Fk(with)515
2848 y(name)d(the)h(treere)o(x)o(e)o(xp)d(rule)j Fj(name)p
Fk(.)27 b(Therefore,)18 b(after)j(compilation)e(a)j(subroutine)d
Fi(wxz)i Fk(will)h(be)515 2947 y(a)n(v)n(ailable.)i(The)18
b(dot)g(in)g(the)g Fj(term)h Fi(TIMES\(.,)49 b(NUM\))18
b Fk(matches)g(an)o(y)f(tree.)24 b(The)18 b(semantic)g(con-)515
3047 y(dition)j(states)i(that)f(the)g Fi(attr)g Fk(entry)f(of)h(node)f
Fi(NUM)h Fk(must)g(be)f(zero.)30 b(The)22 b Fj(tr)o(ansformation)e
(code)515 3147 y Fk(-)g(that)g(will)g(be)g(applied)e(only)h(if)h(the)g
(matching)f(succeeded)f(-)i(substitutes)g(the)g(whole)f(subtree)g(by)
515 3246 y(its)i(right)f(child.)639 3346 y(References)d(to)h(the)f
(nodes)g(associated)h(with)f(some)h Fi(CLASS)f Fk(appearing)e(in)j(the)
g Fj(term)g Fk(section)515 3445 y(can)f(be)h(accessed)g(inside)f(the)h
(semantic)f(parts)h(through)e(the)h(le)o(xical)h(v)n(ariable)f
Fi($CLASS)p Fk(.)f(If)i(there)515 3545 y(is)27 b(more)f(than)g(one)g
(node)f(the)i(associated)f(v)n(ariable)f(is)j Fi(@CLASS)p
Fk(.)e(V)-9 b(ariable)25 b Fi($_[0])h Fk(refers)g(to)515
3645 y(the)20 b(root)f(of)h(the)h(subtree)e(that)h(matched.)639
3744 y(Nodes)26 b(inside)h(a)f Fj(term)h Fk(can)g(be)f(described)f
(using)h(linear)g(re)o(gular)e(e)o(xpressions)h(lik)o(e)i(in)g(the)515
3844 y Fi(fold)20 b Fk(transformation:)515 4010 y Fi
(/TIMES|PLUS|DIV|MINUS/:b\(NUM,)44 b(NUM\))515 4176 y
Fk(In)18 b(such)h(cases)g(an)g(optional)f(identi\002er)g(to)h(later)g
(refer)f(the)h(node)f(that)h(matched)e(can)i(be)g(speci\002ed)515
4276 y(\()p Fi(b)h Fk(in)g(the)h(e)o(xample\).)639 4375
y(T)m(ree)f(transformations)e(can)i(be)g(grouped)e(in)i(f)o(amilies:)
515 4558 y Fi(algebra)48 b(=)i(fold)f(wxz)g(zxw)g(neg;)p
515 4624 1146 4 v 605 4680 a Fd(4)634 4703 y Fc(The)25
b(sub)f(must)g(be)h(accessed)h(through)g(a)f(proxy)g
Fb(Parse::Eyapp::YATW)c Fc(object.)45 b(Y)-8 b(A)h(TW)23
b(stands)i(for)f Fa(Y)-6 b(et)515 4782 y(Another)17 b(T)l(r)n(ee)h(W)-6
b(alk)o(er)p eop end
%%Page: 16 16
TeXDict begin 16 15 bop 639 523 a Fk(Such)19 b(f)o(amilies)f(-)h(and)f
(the)h(objects)g(the)o(y)f(collect)g(-)h(are)g(a)n(v)n(ailable)f
(inside)g(the)h(client)g(program)515 623 y(\(read)14
b(ane)n(w)h(the)h(code)e(of)h(the)h(dri)n(v)o(er)e(in)h(section)g(3\).)
23 b(Thus,)16 b(if)g Fi($t)f Fk(holds)g(the)g(AST)h(resulting)f(from)
515 722 y(the)24 b(parsing)f(phase,)h(we)g(can)g(call)h(its)g(method)d
Fi(s)i Fk(\(for)f(substitute\))h(with)g(ar)o(gs)f(the)h
Fi(@algebra)515 822 y Fk(f)o(amily:)515 988 y Fi($t->s\(our)48
b(@algebra\);)639 1154 y Fk(The)19 b Fi(s)h Fk(method)d(of)i
Fi(Parse::Eyapp::Node)2115 1124 y Fe(5)2165 1154 y Fk(proceeds)e(to)j
(apply)e(all)i(the)f(transforma-)515 1254 y(tion)k(in)g(the)h(f)o
(amily)e Fi(@algebra)h Fk(to)g(tree)h Fi($t)f Fk(until)g(none)f(of)h
(them)g(matches.)34 b(Thus,)24 b(for)e(input)515 1353
y Fi(a)49 b(=)h(2)764 1368 y(*)814 1353 y(\(a+b\))1064
1368 y(*)1114 1353 y(\(2-4/2\))18 b Fk(the)i(parser)g(produces)e(the)i
(follo)n(wing)f(tree:)515 1519 y Fi
(\230/LEyapp/examples/ParsingStringsAn)o(dTree)o(s$)44
b(perl)49 b(-wd)g(infix2pir.pl)515 1719 y(Loading)f(DB)i(routines)e
(from)h(perl5db.pl)f(version)h(1.31)515 1818 y(Editor)f(support)h
(available.)515 2017 y(Enter)g(h)g(or)h(`h)f(h')h(for)f(help,)g(or)g
(`man)g(perldebug')f(for)h(more)g(help.)515 2217 y
(main::\(infix2pir.pl:41\):)195 b(my)49 b($filename)f(=)i(shift;)614
2316 y(DB<1>)f(l)h(41,52)2141 b(#)50 b(let)f(us)g(remind)g(the)g(code)g
(involved)515 2416 y(41==>)148 b(my)50 b($filename)e(=)h(shift;)515
2516 y(42:)g(my)g($parser)g(=)h(Infix->new\(\);)515 2615
y(43:)f($parser->slurp_file\($filename\);)515 2715 y(44)515
2814 y(45:)g(my)g($t)h(=)f($parser->YYParse\(\))e(||)i(exit\(1\);)515
2914 y(46)515 3014 y(47)99 b(#)50 b(Machine)e(independent)g
(optimizations)515 3113 y(48:)h($t->s\(our)f(@algebra\);)515
3213 y(49)515 3313 y(50)99 b(#)50 b(Address)e(Assignment)515
3412 y(51:)h(our)g($reg_assign;)515 3512 y(52:)g($reg_assign->s\($t\);)
614 3611 y(DB<2>)g(c)h(48)2341 b(#)49 b(get)h(input)e(and)i(build)f
(the)g(AST)515 3711 y(a)g(=)h(2)764 3726 y(*)814 3711
y(\(a+b\))1064 3726 y(*)1114 3711 y(\(2-4/2\))515 3811
y(main::\(infix2pir.pl:48\):)195 b($t->s\(our)48 b(@algebra\);)614
3910 y(DB<3>)h(p)h($t->str)515 4010 y
(EXPS\(ASSIGN\(VAR[a],TIMES\(TIMES\(NUM)o([2],P)o(LUS\(VA)o(R[a],)o
(VAR[b)o(]\)\),MI)o(NUS\(N)o(UM[2])o(,DIV\(N)o(UM[4])o(,NUM[)o
(2]\)\)\)\))o(\))515 4176 y Fk(Which)20 b(is)h(transformed)d(by)i(the)g
(call)g Fi($t->s\(@algebra\))e Fk(onto)i(this)h(optimized)d(v)o
(ersion:)614 4342 y Fi(DB<4>)49 b(n)515 4442 y
(main::\(infix2pir.pl:51\):)195 b(our)49 b($reg_assign;)614
4541 y(DB<4>)g(p)h($t->str)515 4641 y(EXPS\(ASSIGN\(VAR[a],NUM[0]\)\))
515 4824 y(EXPS\(ASSIGN\(VAR[a],NUM[0]\)\))p 515 4886
1146 4 v 605 4941 a Fd(5)634 4965 y Fc(All)18 b(the)g(classes)g(in)f
(the)h(AST)e(inherit)j(from)d Fb(Parse::Eyapp::Node)p
eop end
%%Page: 17 17
TeXDict begin 17 16 bop 515 523 a Fl(7)119 b(Resour)n(ce)30
b(Allocation)515 709 y Fk(The)25 b(back-end)e(of)i(the)g(translator)g
(starts)h(with)f(resource)f(assignment.)40 b(The)25 b(only)f(resource)g
(to)515 808 y(consider)16 b(here)g(is)i(memory)-5 b(.)22
b(W)-7 b(e)18 b(ha)n(v)o(e)e(to)i(assign)f(a)g(memory)f(location)g
(and/or)f(machine)h(re)o(gister)515 908 y(to)f(each)h(of)f(the)h(v)n
(ariables)f(and)g(inner)f(nodes)h(in)h(the)g(AST)-6 b(.)15
b(The)g(\002nal)h(tar)o(get)f(machine,)g(P)o(arrot,)h(is)g(a)515
1007 y(re)o(gister)i(based)h(interpreter)f(with)i(32)f(\003oating)f
(point)h(re)o(gisters.)24 b(On)c(top)f(of)g(the)g(P)o(arrot)g(machine)
515 1107 y(is)25 b(a)h(layer)e(named)g(P)o(arrot)g(Intermediate)e
(Representation)i(\(PIR\).)g(The)h(PIR)g(language)e(and)i(its)515
1207 y(compiler)g(\()p Fi(imcc)p Fk(\))i(mak)o(e)f(remarkably)f(easier)
i(the)g(task)h(of)e(mapping)f(v)n(ariables)i(to)g(re)o(gisters:)515
1306 y(PIR)18 b(pro)o(vides)e(an)i(in\002nite)g(number)e(of)h(virtual)g
(numeric)g(re)o(gisters)g(named)g Fi($N1)p Fk(,)h Fi($N2)p
Fk(,)g(etc.)24 b(and)515 1406 y(solv)o(es)c(the)g(problem)e(of)i
(mapping)f(v)n(ariables)g(into)h(re)o(gisters)g(via)g(Graph)f(Coloring)
g([8)o(].)639 1506 y(As)k(it)g(sho)n(ws)f(in)h(the)f(code)g(belo)n(w)f
(\(in)h(\002le)h Fi(I2PIR.trg)p Fk(\),)e(the)h(resource)f(allocation)g
(stage)515 1605 y(is)g(limited)f(to)g(assign)h(virtual)e(re)o(gisters)h
(to)g(the)g(inner)g(nodes:)714 1788 y Fi({{)49 b(my)h($num)f(=)h(1;)f
(#)h(closure)814 1888 y(sub)f(new_N_register)e({)913
1987 y(return)i('$N'.$num++;)814 2087 y(})714 2186 y(}})714
2386 y(reg_assign:)f($x)99 b(=>)49 b({)814 2485 y(if)g(\(ref\($x\))f
(=\230)i(/VAR|NUM/\))e({)913 2585 y($x->{reg})g(=)i($x->{attr};)913
2685 y(return)f(1;)814 2784 y(})814 2884 y(if)g(\(ref\($x\))f(=\230)i
(/ASSIGN/\))e({)913 2983 y($x->{reg})g(=)i($x->child\(0\)->{attr};)913
3083 y(return)f(1;)814 3183 y(})814 3282 y($_[0]->{reg})e(=)j
(new_N_register\(\);)714 3382 y(})639 3565 y Fk(A)33
b(treere)o(ge)o(xp)e(term)h(lik)o(e)h Fi($x)g Fk(matches)f(an)o(y)g
(node)g(and)g(creates)g(a)h(le)o(xical)g(v)n(ariable)e
Fi($x)515 3664 y Fk(containing)18 b(a)j(reference)d(to)i(the)h(node)e
(that)h(matched.)639 3764 y(In)28 b(between)f(T)m(reere)o(ge)o(xp)d
(rules)k(the)g(programmer)c(can)k(insert)g(Perl)g(code)f(between)f
(curly)515 3863 y(brack)o(ets.)39 b(The)25 b(code)g(will)h(be)f
(inserted)f(v)o(erbatim)2033 3833 y Fe(6)2090 3863 y
Fk(at)i(that)f(relati)n(v)o(e)g(point)f(by)h(the)g Fi(treereg)515
3963 y Fk(compiler)-5 b(.)639 4063 y(The)36 b(P)o(arse::Eyapp::Y)-10
b(A)h(TW)33 b(object)j Fi($reg_assign)e Fk(generated)g(by)h(the)g
(compiler)g(is)515 4162 y(a)n(v)n(ailable)19 b(inside)i(the)f(main)g
(dri)n(v)o(er)e(\(re)n(vise)i(section)g(3\):)515 4328
y Fi(our)49 b($reg_assign;)814 4428 y($reg_assign->s\($t\);)515
4594 y Fk(No)n(w)19 b(we)h(ha)n(v)o(e)f(an)g(AST)h Fj(decor)o(ated)d
Fk(with)j(a)g(ne)n(w)f(attrib)n(ute)g Fi(reg)p Fk(.)25
b(The)19 b(follo)n(wing)f(session)h(with)515 4694 y(the)h(deb)n(ugger)e
(illustrates)j(the)f(w)o(ay)g(to)g(e)o(xpose)f(the)i(AST)f(and)g(its)h
(attrib)n(utes:)p 515 4765 1146 4 v 605 4820 a Fd(6)634
4844 y Fc(W)m(ithout)g(the)f(outer)g(curly)h(brack)o(ets.)29
b(If)19 b(it)g(weren')o(t)i(for)e(the)h(second)g(pair)g(of)f(curly)i
(brack)o(ets)g(the)f(le)o(xical)i(v)n(ariable)515 4923
y Fb($num)16 b Fc(w)o(ould)i(be)f(visible)i(up)e(to)g(the)h(end)f(of)g
(the)h(\002le)p eop end
%%Page: 18 18
TeXDict begin 18 17 bop 714 523 a Fi
(\230/LEyapp/examples/ParsingStringsAnd)o(Trees$)43 b(perl)49
b(-wd)g(infix2pir.pl)f(simple5.inf)714 722 y(Loading)g(DB)i(routines)e
(from)h(perl5db.pl)f(version)h(1.31)714 822 y(Editor)g(support)f
(available.)714 1021 y(Enter)h(h)g(or)h(`h)f(h')h(for)f(help,)g(or)g
(`man)g(perldebug')f(for)i(more)f(help.)714 1220 y
(main::\(infix2pir.pl:41\):)195 b(my)49 b($filename)f(=)i(shift;)814
1320 y(DB<1>)e(l)i(41,55)714 1420 y(41==>)148 b(my)50
b($filename)e(=)i(shift;)714 1519 y(42:)f(my)h($parser)e(=)i
(Infix->new\(\);)714 1619 y(43:)f($parser->slurp_file\($filename\);)714
1719 y(44)714 1818 y(45:)g(my)h($t)f(=)h($parser->YYParse\(\))c(||)k
(exit\(1\);)714 1918 y(46)714 2017 y(47)99 b(#)50 b(Machine)e
(independent)g(optimizations)714 2117 y(48:)h($t->s\(our)f(@algebra\);)
714 2217 y(49)714 2316 y(50)99 b(#)50 b(Address)e(Assignment)714
2416 y(51:)h(our)g($reg_assign;)714 2516 y(52:)g($reg_assign->s\($t\);)
714 2615 y(53)714 2715 y(54)99 b(#)50 b(Translate)e(to)h(PARROT)714
2814 y(55:)g($t->bud\(our)f(@translation\);)814 2914
y(DB<2>)g(c)i(52)714 3014 y(main::\(infix2pir.pl:52\):)195
b($reg_assign->s\($t\);)814 3113 y(DB<3>)48 b(x)i($t->str)714
3213 y(0)99 b('EXPS\(TIMES\(NEG\(VAR[a]\),NUM[2]\)\)')515
3379 y Fk(W)-7 b(e)23 b(ha)n(v)o(e)e(stopped)g(the)h(e)o(x)o(ecution)e
(just)j(before)d(the)j(call)f(to)g Fi($reg_assign->s\($t\))p
Fk(.)28 b(The)515 3479 y(AST)20 b(for)g(input)f Fi(-a)1101
3494 y(*)1151 3479 y(2)h Fk(w)o(as)h(displayed.)j(No)n(w)c(let)h(us)f
(e)o(x)o(ecute)f Fi($reg_assign->s\($t\))p Fk(:)614 3645
y Fi(DB<4>)49 b(n)515 3744 y(main::\(infix2pir.pl:55\):)195
b($t->bud\(our)47 b(@translation\);)515 3910 y Fk(And)19
b(ha)n(v)o(e)h(a)h(look)e(at)i(ho)n(w)e(re)o(gisters)h(ha)n(v)o(e)g
(been)f(allocated:)614 4093 y Fi(DB<4>)913 4108 y(*)963
4093 y(TIMES::info=)1563 4108 y(*)1613 4093 y(NEG::info=)2113
4108 y(*)2163 4093 y(VAR::info=)2663 4108 y(*)2713 4093
y(N)o(UM::i)o(nfo=s)o(ub)44 b({$_[0]{reg}})614 4292 y(DB<5>)49
b($Parse::Eyapp::Node::INDENT=2)614 4491 y(DB<6>)g(x)h($t->str)515
4591 y(0)99 b(')515 4691 y(EXPS\()614 4790 y(TIMES[$N2]\()714
4890 y(NEG[$N1]\()814 4990 y(VAR[a])p eop end
%%Page: 19 19
TeXDict begin 19 18 bop 714 523 a Fi(\),)714 623 y(NUM[2])614
722 y(\))50 b(#)g(TIMES)515 822 y(\))f(#)h(EXPS')614
922 y(DB<7>)515 1104 y Fk(Observ)o(e)19 b(that)h(no)g(re)o(gisters)g
(were)g(allocated)f(for)h(v)n(ariables)f(and)h(numbers.)639
1204 y(After)c(the)g(re)o(gister)g(assignment)f(phase)h(the)g(nodes)f
(ha)n(v)o(e)h(been)f(decorated)g(with)h(the)g(attrib)n(ute)515
1303 y Fi($reg)p Fk(.)639 1403 y(T)-7 b(o)31 b(display)e(the)i(tree)f
(we)g(use)h(the)f Fi(str)g Fk(method)f(of)h(the)g(AST)h(nodes.)54
b(This)31 b(method)e(is)515 1503 y(inherited)14 b(from)g(P)o
(arse::Eyapp::Node.)21 b(The)15 b Fi(str)g Fk(method)f(tra)n(v)o(erses)
h(the)g(syntax)g(tree)g(dumping)515 1602 y(the)25 b(type)f(of)h(the)g
(node)f(being)g(visited)h(in)g(a)h(string.)39 b(If)25
b(the)g(node)f(being)g(visited)h(has)g(a)h(method)515
1702 y Fi(info)16 b Fk(it)i(will)f(be)g(e)o(x)o(ecuted)e(and)h(its)i
(result)f(inserted)f(between)g Fi($DELIMITER)p Fk(s)g(into)g(the)h
(string.)515 1802 y(The)j(P)o(arse::Eyapp::Node)d(v)n(ariable)i
Fi($INDENT)1984 1771 y Fe(7)2037 1802 y Fk(controls)g(the)h(w)o(ay)h
(the)f(tree)g(is)h(displayed.)515 2082 y Fl(8)119 b(Code)31
b(Generation)515 2267 y Fk(The)e(translation)h(is)h(approached)c(as)k
(a)f(particular)f(case)h(of)g Fj(tr)m(ee)h(decor)o(ation)p
Fk(.)52 b(Each)30 b(node)f(is)515 2367 y(decorated)20
b(with)j(a)g(ne)n(w)f(attrib)n(ute)g Fi(trans)g Fk(that)h(will)g(held)f
(the)g(translation)g(for)g(such)g(node.)30 b(T)-7 b(o)515
2467 y(compute)28 b(it,)k(we)e(de\002ne)f(a)h(translation)f
(transformation)e Fi(t_class)i Fk(for)g(each)g(type)g(of)h(node)515
2566 y Fi(class)20 b Fk(in)g(the)g(AST)l(:)714 2732 y
Fi(translation)48 b(=)h(t_num)g(t_var)g(t_op)g(t_neg)g(t_assign)f
(t_list)h(t_print;)639 2898 y Fk(Some)22 b(of)g(these)h
(transformations)d(are)i(straightforw)o(ard.)28 b(The)22
b(translation)g(of)g(a)g Fi(NUM)h Fk(node)515 2998 y(is)e(its)g(v)n
(alue:)714 3164 y Fi(t_num:)49 b(NUM)g(=>)g({)h($NUM->{tr})e(=)i
($NUM->{attr})d(})515 3330 y Fk(The)17 b(translation)g(of)g(a)i(binary)
d(operation)g(node)g Fi($b)i Fk(is)h(to)f(apply)f(the)g(associated)h
(binary)e(operator)515 3430 y Fi($op)25 b Fk(to)g(the)h(re)o(gisters)f
Fi($x->{reg})f Fk(and)g Fi($y->{reg})h Fk(where)f(the)h(operands)f
(were)h(stored)515 3529 y(and)19 b(store)i(it)f(in)h(the)f(re)o(gister)
f Fi($b->{reg})h Fk(associated)g(with)g(the)g(node:)714
3695 y Fi(t_op:)99 b(/TIMES|PLUS|DIV|MINUS/:b\($x,)44
b($y\))50 b(=>)f({)913 3795 y(my)h($op)f(=)h($Op{ref\($b\)};)913
3895 y($b->{tr})f(=)g("$b->{reg})f(=)i($x->{reg})e($op)h($y->{reg}";)
814 3994 y(})515 4160 y Fk(T)-7 b(o)20 b(k)o(eep)g(track)f(of)h(the)h
(in)m(v)n(olv)o(ed)d(v)n(ariables)h(a)i(hash)f(is)h(used)f(as)h(a)f
(rudimentary)e(symbol)h(table:)714 4326 y Fi({)50 b(our)f(\045s;)g(})
714 4426 y(t_assign:)f(ASSIGN\($v,)g($e\))h(=>)h({)814
4526 y($s{$v->{attr}})d(=)i("num";)814 4625 y($ASSIGN->{tr})e(=)j
("$v->{reg})e(=)h($e->{reg}")714 4725 y(})p 515 4787
1146 4 v 605 4842 a Fd(7)634 4865 y Fc(Other)16 b Fb
(Parse::Eyapp::Node)c Fc(v)n(ariables)18 b(go)o(v)o(erning)g(the)e
(beha)o(vior)g(of)g Fb(str)e Fc(are:)21 b Fb(PREFIXES)p
Fc(,)13 b Fb($STRSEP)p Fc(,)515 4944 y Fb($FOOTNOTE)p
879 4944 20 4 v 22 w(HEADER)p Fc(,)j Fb($FOOTNOTE)p 1534
4944 V 22 w(SEP)p Fc(,)g Fb($FOOTNOTE)p 2069 4944 V 23
w(LEFT)p Fc(,)f Fb($FOOTNOTE)p 2644 4944 V 23 w(RIGHT)h
Fc(and)h Fb($LINESEP)p eop end
%%Page: 20 20
TeXDict begin 20 19 bop 515 523 a Fk(The)21 b(former)f(rule)h(says)h
(that)g(the)g(translation)e(of)i(an)f Fi(ASSIGN)g Fk(node)g(consists)h
(in)g(assigning)f(the)515 623 y(contents)c(of)g(the)h(re)o(gister)f
(assigned)h(to)g(the)g(e)o(xpression)e(subtree)h(to)h(the)g(re)o
(gister)f(assigned)h(to)g(the)515 722 y(left)i(hand)f(side.)639
822 y(The)k(translation)g(of)g(the)g(root)g(node)f(\()p
Fi(EXPS)p Fk(\))g(consists)i(of)f(concatenating)e(the)i(translations)
515 922 y(of)d(its)h(children:)515 1088 y Fi({)614 1187
y(sub)50 b(cat_trans)e({)714 1287 y(my)h($t)h(=)f(shift;)714
1486 y(my)g($tr)h(=)f("";)714 1586 y(for)g(\($t->children\))e({)814
1685 y(\(ref\($_\))h(=\230)h(m{NUM|VAR|TERMINAL}\))913
1785 y(or)h($tr)f(.=)g(cat_trans\($_\)."\\n")714 1885
y(})714 1984 y($tr)g(.=)h($t->{tr})e(;)614 2084 y(})515
2183 y(})515 2383 y(t_list:)g(EXPS\(@S\))614 2482 y(=>)i({)714
2582 y($EXPS->{tr})e(=)h("";)714 2682 y(my)g(@tr)h(=)f(map)h({)f
(cat_trans\($_\))f(})h(@S;)714 2781 y($EXPS->{tr})f(=)814
2881 y(reduce)g({)i("$a\\n$b")e(})i(@tr)f(if)h(@tr;)614
2980 y(})515 3147 y Fk(The)30 b(treere)o(ge)o(xp)e Fi(@S)j
Fk(matches)f(the)h(children)e(of)h(the)h Fi(EXPS)f Fk(node.)55
b(The)31 b(associated)f(le)o(xical)515 3246 y(v)n(ariable)19
b Fi(@S)h Fk(contains)g(the)g(references)f(to)h(the)g(nodes)g(that)g
(matched.)639 3346 y(The)k(method)f Fi(bud)1217 3316
y Fe(8)1274 3346 y Fk(of)g(P)o(arse::Eyapp::Node)f(nodes)h(mak)o(es)h
(a)g(bootom)f(up)g(tra)n(v)o(ersing)g(of)515 3445 y(the)d(AST)h
(applying)e(to)h(the)h(node)e(being)h(visited)g(the)h(only)f(one)f
(transformation)f(that)j(matches)3326 3415 y Fe(9)3358
3445 y Fk(.)515 3545 y(After)f(the)g(call)515 3711 y
Fi($t->bud\(our)47 b(@translation\);)515 3877 y Fk(the)20
b(attrib)n(ute)g Fi($t->{trans})e Fk(contains)i(a)h(translation)e(to)h
(PIR)h(for)f(the)g(whole)g(tree.)515 4157 y Fl(9)119
b(P)n(eephole)31 b(T)-9 b(ransf)m(ormations)515 4343
y Fk(The)25 b(name)g Fj(peephole)f(optimizer)i Fk(comes)g(from)e(the)i
(image)f(of)h(sliding)f(a)h(small)g(windo)n(w)f(o)o(v)o(er)515
4443 y(the)19 b(tar)o(get)g(code)g(attempting)g(to)g(replace)g
(patterns)g(of)h(instructions)f(by)g(better)g(ones.)25
b(If)19 b(we)h(ha)n(v)o(e)515 4542 y(a)25 b(look)f(at)h(the)g(code)f
(generated)f(in)i(the)g(pre)n(vious)e(phase)h(for)g(the)h(input)f
Fi(a)50 b(=)f(5-b)3026 4557 y(*)3076 4542 y(2)25 b Fk(we)g(see)515
4642 y(that)20 b(produces:)p 515 4713 1146 4 v 605 4768
a Fd(8)634 4792 y Fc(B)p 634 4805 45 4 v 1 w(ottom-U)p
855 4806 48 4 v 1 w(p)c(D)p 953 4805 V(ecorator)605 4849
y Fd(9)634 4873 y Fc(When)k Fb(bud)f Fc(is)g(applied)j(the)e(f)o(amily)
h(of)f(transformations)i(must)p 2032 4887 130 4 v 19
w(constitute)g(a)e Fa(partition)i Fc(of)d(the)h(AST)f(classes,)i(i.e.)
515 4952 y(for)c(each)h(node)g(one)f(and)h(only)f(one)h(transformation)
i(matches)p eop end
%%Page: 21 21
TeXDict begin 21 20 bop 714 523 a Fi($N1)49 b(=)h(b)1112
538 y(*)1212 523 y(2)714 623 y($N2)f(=)h(5)f(-)h($N1)714
722 y(a)g(=)f($N2)515 858 y Fk(PIR)30 b(allo)n(ws)f(memory)f
(instructions)g(in)m(v)n(olving)g(three)g(ar)o(guments)g(lik)o(e)h
Fi(a)50 b(=)f(b)h(+)g(c)p Fk(.)i(This)515 958 y(f)o(act)19
b(and)g(the)h(observ)n(ation)d(that)i Fi($N2)h Fk(is)g(used)f(only)g
(once)g(lead)g(us)h(to)f(conclude)f(that)i(the)f(former)515
1057 y(translation)g(can)h(be)g(changed)f(to:)714 1193
y Fi($N1)49 b(=)h(b)1112 1208 y(*)1212 1193 y(2)714 1293
y(a)g(=)f(5)h(-)f($N1)515 1428 y Fk(Perl)22 b(re)o(gular)e(e)o
(xpressions)h(constitute)g(a)h(formidable)e(tool)i(to)g(implement)e
Fj(peephole)g(optimiza-)515 1528 y(tion)p Fk(.)k(The)c(re)o(ge)o(xp)e
(belo)n(w)i(\002nds)g(patterns)714 1664 y Fi($N#)49 b(=)h(something)714
1763 y(IDENT)f(=)g($N#)515 1899 y Fk(and)19 b(substitutes)i(them)f(by)f
Fi(IDENT)49 b(=)h(something)p Fk(:)515 2035 y Fi(sub)f
(peephole_optimization)d({)614 2135 y($_[0])j(=\230)h(s{)1162
2234 y(\(\\$N\\d+\)\\s)1662 2249 y(*)1712 2234 y(=\\s)1862
2249 y(*)1912 2234 y(\(.)2012 2249 y(*)2062 2234 y(\\n\)\\s)2312
2249 y(*)2457 2234 y(#)g($N#num)248 b(=)50 b(...)f(something)f(...)1162
2334 y(\([a-zA-Z_]\\w)1762 2349 y(*)1812 2334 y(\)\\s)1962
2349 y(*)2012 2334 y(=\\s)2162 2349 y(*)2212 2334 y(\\1)145
b(#)50 b(IDENTIFIER)e(=)i($N#num)1112 2433 y(})1112 2533
y({$3)g(=)f($2}gx;)746 b(#)50 b(IDENTIFIER)e(=)i(...)f(something)f(...)
515 2633 y(})515 2906 y Fl(10)119 b(Output)31 b(Generation)515
3092 y Fk(Emitting)23 b(the)g(code)g(is)i(the)f(simplest)g(of)f(all)i
(phases.)35 b(Since)24 b(P)o(arrot)f(requires)f(all)j(the)e(v)n
(ariables)515 3191 y(to)h(be)g(declared,)g(a)g(comma)f(separated)h
(string)g Fi($dec)f Fk(is)j(b)n(uilt)e(concatenating)e(the)i(k)o(e)o
(ys)g(of)g(the)515 3291 y(symbol)k(table)h(hash)g Fi(\045s)p
Fk(.)51 b(The)29 b(code)g(is)h(then)e(indented)g(and)g(the)h(dif)n
(ferent)f(components)f(are)515 3390 y(articulated)19
b(through)f(a)j(HERE)f(document:)714 3526 y Fi(sub)49
b(output_code)f({)814 3626 y(my)h(\($trans,)f($dec\))h(=)h(@_;)814
3825 y(#)f(Indent)814 3925 y($$trans)f(=\230)i(s/\210/\\t/gm;)814
4124 y(#)f(Output)g(the)g(code)714 4224 y(print)g(<<)g("TRANSLATION";)
714 4323 y(.sub)g('main')g(:main)714 4423 y(\\t.local)f(num)i($$dec)714
4522 y($$trans)714 4622 y(.end)714 4722 y(TRANSLATION)515
4857 y Fk(The)20 b(call)g(to)h Fi(output_code)d Fk(\002nishes)j(the)f
(job:)714 4993 y Fi(output_code\(\\$t->{trans},)45 b(\\$dec\);)p
eop end
%%Page: 22 22
TeXDict begin 22 21 bop 515 523 a Fl(11)119 b(Conclusions)31
b(and)f(Futur)n(e)h(W)-9 b(ork)515 709 y Fk(This)34 b(w)o(ork)f
(presented)f Fi(Parse::Eyapp)p Fk(,)k(a)e(bottom-up)d(parser)i(that)h
(e)o(xtends)f(the)h Fi(Yacc)515 808 y Fk(LALR)20 b(algorithm)f(and)h
(con\003ict)f(resolution)g(mechanism)g(with)h(dynamic)f(con\003ict)h
(resolution.)639 908 y Fi(Yacc)27 b Fk(and)g Fi(Parse::Yapp)e
Fk(programmers)g(will)i(feel)h(at)f(home)f(in)h Fi(Parse::Eyapp)p
Fk(.)515 1007 y(Additionally)14 b(to)i(the)g(bene\002cial)f(mature)g
(approach)f(to)i(parsing)f(pro)o(vided)f(by)h Fi(Yacc)p
Fk(-lik)o(e)g(parser)515 1107 y(generators,)20 b Fi(Parse::Eyapp)g
Fk(deli)n(v)o(ers)g(a)i(set)h(of)e(e)o(xtensions)f(that)i(gi)n(v)o(e)f
(support)f(to)i(the)f(later)515 1207 y(phases)f(of)g(te)o(xt)g
(processing.)515 1487 y Fl(12)119 b(About)31 b(the)f(A)-6
b(uthor)515 1672 y Fk(Casiano)32 b(Rodriguez-Leon)d(is)k(a)f(Professor)
f(of)h(Computer)f(Science)h(at)g(Uni)n(v)o(ersidad)e(de)i(La)515
1772 y(Laguna.)23 b(His)e(research)f(focuses)f(on)h(P)o(arallel)g
(Computing.)515 2052 y Fl(13)119 b(Ackno)o(wledgements)515
2238 y Fk(This)27 b(w)o(ork)f(has)h(been)f(supported)f(by)h(the)j(E)t
(C)j(\()t(F)t(E)t(D)t(E)t(R)t(\))e(and)c(by)g(the)h(Spanish)f(Ministry)
h(of)515 2337 y(Education)22 b(and)h(Science)h(inside)f(the)h(`Plan)g
(Nacional)f(de)i Fc(I)t Fk(+)t Fc(D)t Fk(+)r(i'.)37 b(Thanks)22
b(T)-7 b(o)24 b(Francois)g(De-)515 2437 y(sarmenien.)f
Fi(Parse::Eyapp)c Fk(shares)h(a)h(lar)o(ge)e(percentage)f(of)i(code)g
(with)g Fi(Parse::Yapp)p Fk(.)515 2717 y Fl(Refer)n(ences)515
2903 y Fk([1])40 b(Damian)47 b(Conw)o(ay)-5 b(.)116 b
Fj(P)-7 b(ar)o(se::RecDescent,)54 b(Gener)o(ate)46 b(Recur)o
(sive-Descent)h(P)-7 b(ar)o(ser)o(s)p Fk(.)653 3002 y(CP)f(AN,)21
b(2003.)515 3169 y([2])40 b(Francois)16 b(Desarmenien.)i
Fj(P)-7 b(ar)o(se::Y)f(app,)16 b(P)-7 b(erl)17 b(e)n(xtension)f(for)g
(g)o(ener)o(ating)e(and)i(using)f(LALR)653 3268 y(par)o(ser)o(s)p
Fk(.)30 b(CP)-8 b(AN,)21 b(2001.)515 3434 y([3])40 b(Allison)20
b(Randal,)g(Dan)g(Sugalski,)f(and)g(Leopold)g(T)-7 b(oetsch.)28
b Fj(P)-7 b(erl)21 b(6)g(and)e(P)-7 b(arr)l(ot)21 b(Essentials,)653
3534 y(Second)e(Edition)p Fk(.)28 b(O'Reilly)20 b(Media,)g(Inc.,)f
(2004.)515 3700 y([4])40 b(The)79 b(P)o(arrot)f(Group.)216
b Fj(P)-7 b(arr)l(ot)80 b(Documentation)p Fk(.)215 b
(http://docs.parrot.or)o(g/,)653 3799 y(http://www)-5
b(.parrot.or)o(g/peop)o(le.)515 3966 y([5])40 b(Alberto)16
b(Manuel)h(Simoes.)22 b(Cooking)16 b(Perl)i(with)f(\003e)o(x.)22
b Fj(The)17 b(P)-7 b(erl)19 b(Re)o(vie)o(w)p Fk(,)e(0\(3\),)f(May)h
(2002.)515 4132 y([6])40 b(Ioannis)19 b(T)-7 b(ambouras.)28
b Fj(P)-7 b(ar)o(se::Fle)n(x,)20 b(The)g(F)-6 b(astest)20
b(Le)n(xer)h(in)g(the)f(W)-8 b(est)p Fk(.)30 b(CP)-8
b(AN,)22 b(2006.)515 4298 y([7])40 b(Stephen)30 b(C.)h(Johnson)e(and)i
(Ra)n(vi)g(Sethi.)63 b(Yacc:)46 b(a)31 b(Parser)g(Generator)-5
b(.)61 b Fj(UNIX)31 b(V)-9 b(ol.)30 b(II:)653 4397 y(r)m(esear)m(c)o(h)
20 b(system)h(\(10th)e(ed.\))p Fk(,)g(pages)h(347\226374,)d(1990.)515
4563 y([8])40 b(Preston)21 b(Briggs.)32 b(Re)o(gister)22
b(Allocation)e(via)h(Graph)g(Coloring.)31 b(T)-6 b(echnical)20
b(Report)h(TR92-)653 4663 y(183,)e(24,)h(1998.)p eop
end
%%Trailer

userdict /end-hook known{end-hook}if
%%EOF
